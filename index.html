
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="installation/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.19">
    
    
      
        <title>requests_oauth2client</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="requests_oauth2client" class="md-header__button md-logo" aria-label="requests_oauth2client" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            requests_oauth2client
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/guillp/requests_oauth2client" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    requests_oauth2client
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="installation/" class="md-tabs__link">
        
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="api/" class="md-tabs__link">
        
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="contributing/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="requests_oauth2client" class="md-nav__button md-logo" aria-label="requests_oauth2client" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    requests_oauth2client
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/guillp/requests_oauth2client" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    requests_oauth2client
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calling-apis-with-access-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Calling APIs with Access Tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-an-oauth2client" class="md-nav__link">
    <span class="md-ellipsis">
      Using an OAuth2Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtaining-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Obtaining tokens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Obtaining tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-oauth2client-as-a-requests-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Using OAuth2Client as a requests Auth Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-credentials-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Client Credentials grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Credentials grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-code-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Code Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization Code Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-authorization-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Authorization Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-the-authorization-response" class="md-nav__link">
    <span class="md-ellipsis">
      Validating the Authorization Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exchanging-code-for-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Exchanging code for tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_1" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#note-on-authorizationrequest" class="md-nav__link">
    <span class="md-ellipsis">
      Note on AuthorizationRequest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-authorization-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Device Authorization Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Device Authorization Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_2" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-initiated-backchannel-authentication-ciba" class="md-nav__link">
    <span class="md-ellipsis">
      Client-Initiated BackChannel Authentication (CIBA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      Token Exchange
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-client-authentication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Client Authentication Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Client Authentication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-secret-basic" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-post" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Post
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-key-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Private Key JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#none" class="md-nav__link">
    <span class="md-ellipsis">
      None
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      Token Revocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-introspection" class="md-nav__link">
    <span class="md-ellipsis">
      Token Introspection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo-requests" class="md-nav__link">
    <span class="md-ellipsis">
      UserInfo Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initializing-an-oauth2client-from-a-discovery-document" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing an OAuth2Client from a discovery document
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specialized-api-client" class="md-nav__link">
    <span class="md-ellipsis">
      Specialized API Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vendor-specific-clients" class="md-nav__link">
    <span class="md-ellipsis">
      Vendor-Specific clients
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calling-apis-with-access-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Calling APIs with Access Tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-an-oauth2client" class="md-nav__link">
    <span class="md-ellipsis">
      Using an OAuth2Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtaining-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Obtaining tokens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Obtaining tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-oauth2client-as-a-requests-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Using OAuth2Client as a requests Auth Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-credentials-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Client Credentials grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Credentials grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-code-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Code Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization Code Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-authorization-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Authorization Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-the-authorization-response" class="md-nav__link">
    <span class="md-ellipsis">
      Validating the Authorization Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exchanging-code-for-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Exchanging code for tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_1" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#note-on-authorizationrequest" class="md-nav__link">
    <span class="md-ellipsis">
      Note on AuthorizationRequest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-authorization-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Device Authorization Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Device Authorization Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_2" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-initiated-backchannel-authentication-ciba" class="md-nav__link">
    <span class="md-ellipsis">
      Client-Initiated BackChannel Authentication (CIBA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      Token Exchange
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-client-authentication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Client Authentication Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Client Authentication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-secret-basic" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-post" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Post
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-key-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Private Key JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#none" class="md-nav__link">
    <span class="md-ellipsis">
      None
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      Token Revocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-introspection" class="md-nav__link">
    <span class="md-ellipsis">
      Token Introspection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo-requests" class="md-nav__link">
    <span class="md-ellipsis">
      UserInfo Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initializing-an-oauth2client-from-a-discovery-document" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing an OAuth2Client from a discovery document
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specialized-api-client" class="md-nav__link">
    <span class="md-ellipsis">
      Specialized API Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vendor-specific-clients" class="md-nav__link">
    <span class="md-ellipsis">
      Vendor-Specific clients
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  
    
      
    
    <a href="https://github.com/guillp/requests_oauth2client/raw/master/docs/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Home</h1>

<!-- BEGIN INCLUDE ../README.md -->
<p><code>requests_oauth2client</code> is an OAuth 2.x client for Python, able to obtain, refresh and revoke tokens from any
OAuth2.x/OIDC compliant Authorization Server. It sits upon and extends the famous <a href="https://requests.readthedocs.io/en/latest/">requests</a> HTTP client module.</p>
<p>It can act as an <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0</a> /
<a href="https://datatracker.ietf.org/doc/draft-ietf-oauth-v2-1">2.1</a> client, to automatically get and renew Access Tokens,
based on the
<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-v2-1-07.html#name-client-credentials">Client Credentials</a>,
<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-v2-1-07.html#name-authorization-code">Authorization Code</a>,
<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-v2-1-07.html#name-refresh-token">Refresh token</a>,
<a href="https://www.rfc-editor.org/rfc/rfc8693.html">Token Exchange</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7523.html#section-2.1">JWT Bearer</a>,
<a href="https://www.rfc-editor.org/rfc/rfc8628.html">Device Authorization</a>,
<a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.3">Resource Owner Password</a> or
<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">CIBA</a> grants. Additional
grant types are easy to add if needed.</p>
<p>It also supports <a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect 1.0</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7636.html">PKCE</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7523.html#section-2.2">Client Assertions</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7009.html">Token Revocation</a> and
<a href="https://www.rfc-editor.org/rfc/rfc7662.html">Introspection</a>,
<a href="https://www.rfc-editor.org/rfc/rfc8707.html">Resource Indicators</a>,
<a href="https://datatracker.ietf.org/doc/rfc9101/">JWT-secured Authorization Requests</a>,
<a href="https://datatracker.ietf.org/doc/rfc9126/">Pushed Authorization Requests</a>,
<a href="https://www.rfc-editor.org/rfc/rfc9207.html">Authorization Server Issuer Identification</a>, as well as using custom
params to any endpoint, and other important features that are often overlooked in other client libraries.</p>
<p>And it also includes a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">wrapper</a> around <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session">requests.Session</a> that makes it super easy to use REST-style APIs,
with or without OAuth 2.x.</p>
<p>Please note that despite the name, this library has no relationship with Google
<a href="https://github.com/googleapis/oauth2client">oauth2client</a> library.</p>
<p><a href="https://www.python.org/"><img alt="made-with-python" src="https://img.shields.io/badge/Made%20with-Python-1f425f.svg" /></a>
<a href="https://pypi.org/project/black/"><img alt="PyPi version" src="https://img.shields.io/pypi/v/black" /></a>
<a href="https://pepy.tech/project/requests_oauth2client"><img alt="Downloads" src="https://static.pepy.tech/badge/requests_oauth2client/month" /></a>
<a href="https://pypi.org/project/requests_oauth2client"><img alt="Supported Versions" src="https://img.shields.io/pypi/pyversions/requests_oauth2client.svg" /></a>
<a href="https://pypi.com/project/requests_oauth2client/"><img alt="PyPi license" src="https://badgen.net/pypi/license/requests_oauth2client/" /></a>
<a href="https://pypi.python.org/pypi/requests_oauth2client/"><img alt="PyPI status" src="https://img.shields.io/pypi/status/requests_oauth2client.svg" /></a>
<a href="https://github.com/guillp/requests_oauth2client/commit/"><img alt="GitHub commits" src="https://badgen.net/github/commits/guillp/requests_oauth2client" /></a>
<a href="https://github.com/guillp/requests_oauth2client/commit/"><img alt="GitHub latest commit" src="https://badgen.net/github/last-commit/guillp/requests_oauth2client" /></a>
<a href="https://github.com/astral-sh/ruff"><img alt="Ruff" src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/ruff/main/assets/badge/v2.json" /></a></p>
<h2 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h2>
<p>Full module documentation is available at https://guillp.github.io/requests_oauth2client/</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p><code>requests_oauth2client</code> is <a href="https://pypi.org/project/requests-oauth2client/">available from PyPi</a>, so installing it is
as easy as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>requests_oauth2client
</code></pre></div></td></tr></table></div>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Everything from <code>requests_oauth2client</code> is available from the root module, so you can import it like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></td></tr></table></div>
<p>Or you can import individual objects from this package as usual. Note that importing <code>*</code> automatically imports
<code>requests</code>, so no need to import it yourself.</p>
<h3 id="calling-apis-with-access-tokens">Calling APIs with Access Tokens<a class="headerlink" href="#calling-apis-with-access-tokens" title="Permanent link">&para;</a></h3>
<p>If you already managed to obtain an access token for the API you want to call, you can simply use the <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.BearerAuth">BearerAuth</a> Auth
Handler for <a href="https://requests.readthedocs.io/en/latest/">requests</a>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">BearerAuth</span>

<span class="n">token</span> <span class="o">=</span> <span class="s2">&quot;an_access_token&quot;</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://my.protected.api/endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">BearerAuth</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<p>This authentication handler will add a <code>Authorization: Bearer &lt;access_token&gt;</code> header in the request, with your access
token, properly formatted according to <a href="https://datatracker.ietf.org/doc/html/rfc6750#section-2.1">RFC6750</a>.</p>
<h3 id="using-an-oauth2client">Using an OAuth2Client<a class="headerlink" href="#using-an-oauth2client" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> offers several methods that implement the communication to the various endpoints that are standardised by
OAuth 2.0 and its extensions. Those endpoints include the Token Endpoint, the Revocation, Introspection, UserInfo,
BackChannel Authentication and Device Authorization Endpoints.</p>
<p>You have to provide the URLs for those endpoints if you intend to use them. Otherwise, only the Token Endpoint is
mandatory to initialize an <code>OAuth2Client</code>.</p>
<p>To initialize an instance of <code>OAuth2Client</code>, you only need a Token Endpoint URI from your AS, and the credentials for
your application, which are typically a <code>client_id</code> and a <code>client_secret</code>, usually also provided by the AS:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;my_client_id&quot;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;my_client_secret&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>The Token Endpoint is the only endpoint that is mandatory to obtain tokens. Credentials are used to authenticate the
client everytime it sends a request to its Authorization Server. Usually, those are a static Client ID and Secret, which
are the direct equivalent of a username and a password, but meant for an application instead of for a human user. The
default authentication method used by <code>OAuth2Client</code> is <em>Client Secret Post</em>, but other standardised methods such as
<em>Client Secret Basic</em>, <em>Client Secret JWT</em> or <em>Private Key JWT</em> are supported as well. See
<a href="..#supported-client-authentication-methods">more about client authentication methods below</a>.</p>
<p>Instead of providing each endpoint URL yourself, you may also
<a href="..#initializing-an-oauth2client-from-a-discovery-document">use the AS metadata endpoint URI</a>, or the document data
itself, to initialize your OAuth 2.0 client with the appropriate endpoints.</p>
<h3 id="obtaining-tokens">Obtaining tokens<a class="headerlink" href="#obtaining-tokens" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> has dedicated methods to send requests to the Token Endpoint using the different standardised (and/or
custom) grants. Since the Token Endpoint URL and Client Authentication Method to use are already declared for the client
at init time, the only required parameters for those methods are those that will be sent in the request to the Token
Endpoint.</p>
<p>Those methods directly return a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> if the request is successful, or raise an exception if it fails.
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> contains all the data as returned by the Token Endpoint, including the Access Token. It will:</p>
<ul>
<li>keep track of the Access Token expiration date (based on the <code>expires_in</code> hint as returned by the AS). This date is
  accessible with the <code>expires_at</code> attribute.</li>
<li>contain the Refresh Token, if returned by the AS, accessible with the <code>refresh_token</code> attribute.</li>
<li>contain the ID Token, if returned by the AS, accessible with the <code>Ã¬d_token</code> attribute (when using the Authorization
  Code flow).</li>
<li>keep track of other associated metadata as well, also accessible as attributes with the same name:
  <code>token.custom_attr</code>, or with subscription syntax <code>token["my.custom.attr"]</code>.</li>
</ul>
<p>You can create such a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> yourself if you need:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">BearerToken</span>

<span class="n">bearer_token</span> <span class="o">=</span> <span class="n">BearerToken</span><span class="p">(</span><span class="n">access_token</span><span class="o">=</span><span class="s2">&quot;an_access_token&quot;</span><span class="p">,</span> <span class="n">expires_in</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bearer_token</span><span class="p">)</span>
<span class="c1"># {&#39;access_token&#39;: &#39;an_access_token&#39;,</span>
<span class="c1">#  &#39;expires_in&#39;: 55,</span>
<span class="c1">#  &#39;token_type&#39;: &#39;Bearer&#39;}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bearer_token</span><span class="o">.</span><span class="n">expires_at</span><span class="p">)</span>
<span class="c1"># datetime.datetime(2021, 8, 20, 9, 56, 59, 498793)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">bearer_token</span><span class="o">.</span><span class="n">is_expired</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">bearer_token</span><span class="o">.</span><span class="n">expires_in</span><span class="p">)</span>
<span class="c1"># 40</span>
</code></pre></div></td></tr></table></div>
<p>Note that the <code>expires_in</code> indicator here is not static. It keeps track of the token lifetime, in seconds, and is
calculated as the time flies. The actual static expiration date is accessible with the <code>expires_at</code> property. You can
check if a token is expired with
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken.is_expired">bearer_token.is_expired()</a>.</p>
<p>You can use a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> instance anywhere you can use an access_token as string.</p>
<h4 id="using-oauth2client-as-a-requests-auth-handler">Using OAuth2Client as a requests Auth Handler<a class="headerlink" href="#using-oauth2client-as-a-requests-auth-handler" title="Permanent link">&para;</a></h4>
<p>While using <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> directly is great for testing or debugging OAuth2.x flows, it is not a viable option for
actual applications where tokens must be obtained, used during their lifetime then obtained again or refreshed once they
are expired. <code>requests_oauth2client</code> contains several <a href="https://requests.readthedocs.io/en/latest/">requests</a> compatible Auth Handlers (as subclasses of
<a href="https://requests.readthedocs.io/en/latest/user/advanced/#custom-authentication">requests.auth.AuthBase</a>), that will
take care of obtaining tokens when required, then will cache those tokens until they are expired, and will obtain new
ones (or refresh them, when possible), once the initial token is expired. Those are best used with a <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session">requests.Session</a>,
or an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a>, which is a wrapper around <code>Session</code> with a few enhancements as described below.</p>
<h4 id="client-credentials-grant">Client Credentials grant<a class="headerlink" href="#client-credentials-grant" title="Permanent link">&para;</a></h4>
<p>To send a request using the Client Credentials grant, use the aptly named
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.client_credentials">.client_credentials()</a>
method, with the parameters to send in the token request as keyword parameters:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">)</span>
<span class="c1"># or, if your AS uses resource indicator:</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;https://myapi.local&quot;</span><span class="p">)</span>
<span class="c1"># or, if your AS uses &#39;audience&#39; as parameter to identify the requested API (Auth0 style):</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">audience</span><span class="o">=</span><span class="s2">&quot;https://myapi.local&quot;</span><span class="p">)</span>
<span class="c1"># or, if your AS uses custom parameters:</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span> <span class="n">custom_param</span><span class="o">=</span><span class="s2">&quot;custom_value&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Parameters such as <code>scope</code>, <code>resource</code> or <code>audience</code> or any other parameter that may be required by the AS can be passed
as keyword parameters. Those will be included in the token request that is sent to the AS. <code>scope</code> is not mandatory at
client level (but it might be required by your AS to serve your request).</p>
<h5 id="as-auth-handler">As Auth Handler<a class="headerlink" href="#as-auth-handler" title="Permanent link">&para;</a></h5>
<p>You can use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2ClientCredentialsAuth">OAuth2ClientCredentialsAuth</a>
auth handler. It takes an <code>OAuth2Client</code> as parameter, and the additional kwargs to pass to the token endpoint:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span>
    <span class="n">oauth2client</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;https://myapi.local&quot;</span>
<span class="p">)</span>

<span class="c1"># use it like this:</span>
<span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://myapi.local/resource&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>

<span class="c1"># or like this:</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">auth</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://myapi.local/resource&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Once again, extra parameters such as <code>scope</code>, <code>resource</code> or <code>audience</code> are allowed if required.</p>
<p>When you send your first request,
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2ClientCredentialsAuth">OAuth2ClientCredentialsAuth</a>
will automatically retrieve an access token from the AS using the Client Credentials grant, then will include it in the
request. Next requests will use the same token, as long as it is valid. A new token will be automatically retrieved once
the previous one is expired.</p>
<p>You can configure a leeway, which is a period of time before the actual expiration, in seconds, when a new token will be
obtained. This may help getting continuous access to the API when the client and API clocks are slightly out of sync.
Use the parameter <code>leeway</code> to <code>OAuth2ClientCredentialsAuth</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2ClientCredentialsAuth</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span>
    <span class="n">oauth2client</span><span class="p">,</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span>
    <span class="n">leeway</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="authorization-code-grant">Authorization Code Grant<a class="headerlink" href="#authorization-code-grant" title="Permanent link">&para;</a></h4>
<p>Obtaining tokens using the Authorization code grant is made in 3 steps:</p>
<ol>
<li>
<p>your application must open a specific url called the <em>Authentication Request</em> in a browser.</p>
</li>
<li>
<p>your application must obtain and validate the <em>Authorization Response</em>, which is a redirection back to your
   application that contains an <em>Authorization Code</em> as parameter. This redirect back (often called "callback") is
   initiated by the Authorization Server after any necessary interaction with the user is complete (Registration, Login,
   Profile completion, Multi-Factor Authentication, Authorization, Consent, etc.)</p>
</li>
<li>
<p>your application must then exchange this Authorization Code for an <em>Access Token</em>, with a request to the Token
   Endpoint.</p>
</li>
</ol>
<p>Using an <code>OAuth2Client</code> will help you with all those steps, as described below.</p>
<h5 id="generating-authorization-requests">Generating Authorization Requests<a class="headerlink" href="#generating-authorization-requests" title="Permanent link">&para;</a></h5>
<p>To be able to use the Authorization Code grant, you need 2 (optionally 3) URIs:</p>
<ul>
<li>the URL for Authorization Endpoint, which is the url where you must send your Authorization Requests</li>
<li>the Redirect URI, which is the url pointing to your application, where the Authorization Server will reply with
  Authorization Response</li>
<li>optionally, the issuer identifier, if your AS uses
  <a href="https://www.rfc-editor.org/rfc/rfc9207.html">Issuer Identification</a>.</li>
</ul>
<p>You can declare those URIs when initializing your <code>OAuth2Client</code> instance, or you can
<a href="..#initializing-an-oauth2client-from-a-discovery-document">use the AS discovery endpoint</a> to initialize those URLs
automatically. Then you can generate valid Authorization Requests by calling the method <code>.authorization_request()</code>, with
the request specific parameters, such as <code>scope</code>, <code>state</code>, <code>nonce</code> as parameter:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endoint&quot;</span><span class="p">,</span>
    <span class="n">authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/authorization_endpoint&quot;</span><span class="p">,</span>
    <span class="n">redirect_uri</span><span class="o">=</span><span class="s2">&quot;https://url.to.my.application/redirect_uri&quot;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">az_request</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorization_request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;openid email profile&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">az_request</span><span class="p">)</span>
<span class="c1"># this will look like this, with line feeds for display purposes only:</span>
<span class="c1"># https://url.to.the.as/authorization_endpoint</span>
<span class="c1"># ?client_id=client_id</span>
<span class="c1"># &amp;redirect_uri=https%3A%2F%2Furl.to.my.application%2Fredirect_uri</span>
<span class="c1"># &amp;response_type=code</span>
<span class="c1"># &amp;scope=openid+email+profile</span>
<span class="c1"># &amp;state=FBx9mWeLwoKGgG76vhi6v61-4mgxmgZhtWIa7aTffdY</span>
<span class="c1"># &amp;nonce=iHZJokhkGOAojff1tdknRyz9mPZyy5vq9JDlVaUHyqk</span>
<span class="c1"># &amp;code_challenge=TG7qgdyKnwUPuoQ6NNJRlLMoHbeVmJlB8g0VOcfQEkc</span>
<span class="c1"># &amp;code_challenge_method=S256</span>

<span class="c1"># you can send the user to that url with:</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>

<span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">az_request</span><span class="o">.</span><span class="n">uri</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Note that the <code>state</code>, <code>nonce</code> and <code>code_challenge</code> parameters are generated with secure random values by default.
Should you wish to use your own values, you can pass them as parameters to <code>OAuth2Client.authorization_request()</code>. For
PKCE, you need to pass your generated <code>code_verifier</code>, and the <code>code_challenge</code> will automatically be derived from it.
If you want to disable PKCE, you can pass <code>code_challenge_method=None</code> when initializing your <code>OAuth2Client</code>.</p>
<h5 id="validating-the-authorization-response">Validating the Authorization Response<a class="headerlink" href="#validating-the-authorization-response" title="Permanent link">&para;</a></h5>
<p>Once you have redirected the user browser to the Authorization Request URI, and after the user is successfully
authenticated and authorized, plus any other extra interactive step is complete, the AS will respond with a redirection
to your redirect_uri. That is the <em>Authorization Response</em>. It contains several parameters that must be retrieved by
your client. The <em>Authorization Code</em> is one of those parameters, but you must also validate that the <em>state</em> matches
your request; if using <a href="https://www.rfc-editor.org/rfc/rfc9207.html">AS Issuer Identification</a>, you must also validate
that the issuer matches what is expected. You can do this with:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># using the `az_request` as defined above</span>

<span class="n">response_uri</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
    <span class="s2">&quot;Please enter the full url and/or params obtained on the redirect_uri: &quot;</span>
<span class="p">)</span>
<span class="c1"># say the callback url is https://url.to.my.application/redirect_uri?code=an_az_code&amp;state=FBx9mWeLwoKGgG76vhi6v61-4mgxmgZhtWIa7aTffdY&amp;issuer=https://url.to.the.as</span>
<span class="n">az_response</span> <span class="o">=</span> <span class="n">az_request</span><span class="o">.</span><span class="n">validate_callback</span><span class="p">(</span><span class="n">response_uri</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This <code>auth_response</code> is an <code>AuthorizationResponse</code> instance and contains everything that is needed for your application
to complete the authentication and get its tokens from the AS.</p>
<h5 id="exchanging-code-for-tokens">Exchanging code for tokens<a class="headerlink" href="#exchanging-code-for-tokens" title="Permanent link">&para;</a></h5>
<p>Once you have obtained the AS response, containing an authorization code, your application must exchange it for actual
Token(s).</p>
<p>To exchange a code for Access and/or ID tokens, use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.authorization_code">OAuth2Client.authorization_code()</a>
method. If you have obtained an AuthorizationResponse as described above, you can simply do:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">authorization_code</span><span class="p">(</span><span class="n">az_response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This will automatically include the <code>code</code>, <code>redirect_uri</code> and <code>code_verifier</code> parameters in the Token Request, as
expected by the AS. You may include extra parameters if required, or you may pass your own parameters, without using an
<code>AuthorizationResponse</code> instance, like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">authorization_code</span><span class="p">(</span>
    <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span>
    <span class="n">code_verifier</span><span class="o">=</span><span class="n">code_verifier</span><span class="p">,</span>
    <span class="n">redirect_uri</span><span class="o">=</span><span class="n">redirect_uri</span><span class="p">,</span>
    <span class="n">custom_param</span><span class="o">=</span><span class="n">custom_value</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h5 id="as-auth-handler_1">As Auth Handler<a class="headerlink" href="#as-auth-handler_1" title="Permanent link">&para;</a></h5>
<p>The
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2AuthorizationCodeAuth">OAuth2AuthorizationCodeAuth</a>
handler takes an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> and an authorization code as parameter, plus whatever additional keyword parameters are
required by your Authorization Server:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2AuthorizationCodeAuth</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/authorization_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">api_client</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
    <span class="s2">&quot;https://your.protected.api/endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2AuthorizationCodeAuth</span><span class="p">(</span>
        <span class="n">oauth2client</span><span class="p">,</span>
        <span class="s2">&quot;my_authorization_code&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># any request using api_client will trigger exchanging the code for an access_token, which is then cached, and refreshed later if needed</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2AuthorizationCodeAuth">OAuth2AuthorizationCodeAuth</a>
will take care of refreshing the token automatically once it is expired, using the refresh token, if available.</p>
<h4 id="note-on-authorizationrequest">Note on AuthorizationRequest<a class="headerlink" href="#note-on-authorizationrequest" title="Permanent link">&para;</a></h4>
<p>Authorization Requests generated by <code>OAuth2Client.authorization_request()</code> are instance of the class
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.authorization_request.AuthorizationRequest"><code>AuthorizationRequest</code></a>.
You can also use that class directly to generate your requests, but in that case you need to supply your Authorization
Endpoint URI, your <code>client_id</code>, <code>redirect_uri</code>, etc. You can access every parameter from an <code>AuthorizationRequest</code>
instance, as well as the generated <code>code_verifier</code>, as attributes of this instance. Once an Authorization Request URL is
generated, it your application responsibility to redirect or otherwise send the user to that URL. You may use the
<code>webbrowser</code> module from Python standard library to do so. Here is an example for generating Authorization Requests:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">AuthorizationRequest</span>

<span class="n">az_request</span> <span class="o">=</span> <span class="n">AuthorizationRequest</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/authorization_endpoint&quot;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;my_client_id&quot;</span><span class="p">,</span>
    <span class="n">redirect_uri</span><span class="o">=</span><span class="s2">&quot;http://localhost/callback&quot;</span><span class="p">,</span>  <span class="c1"># this redirect_uri is specific to your app</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;openid email profile&quot;</span><span class="p">,</span>
    <span class="c1"># extra parameters such as `resource` can be included as well if required by your AS</span>
    <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;https://my.resource.local/api&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">az_request</span>
<span class="p">)</span>  <span class="c1"># this request will look like this, with line breaks for display purposes only</span>
<span class="c1"># https://url.to.the/authorization_endpoint</span>
<span class="c1"># ?client_id=my_client_id</span>
<span class="c1"># &amp;redirect_uri=http%3A%2F%2Flocalhost%callback</span>
<span class="c1"># &amp;response_type=code</span>
<span class="c1"># &amp;state=kHWL4VwcbUbtPR4mtht6yMAGG_S-ZcBh5RxI_IGDmJc</span>
<span class="c1"># &amp;nonce=mSGOS1M3LYU9ncTvvutoqUR4n1EtmaC_sQ3db4dyMAc</span>
<span class="c1"># &amp;scope=openid+email+profile</span>
<span class="c1"># &amp;code_challenge=W3n02f6xUKoDVbmhWEWz3h780b-Ci6ucnBS_d7nogmQ</span>
<span class="c1"># &amp;code_challenge_method=S256</span>
<span class="c1"># &amp;resource=https%3A%2F%2Fmy.resource.local%2Fapi</span>

<span class="nb">print</span><span class="p">(</span><span class="n">az_request</span><span class="o">.</span><span class="n">code_verifier</span><span class="p">)</span>
<span class="c1"># &#39;gYK-ZnQfoat2bghwed7oEz--wvn4D70ksJ5GuWO9sXXygZ7PMnUlSpBmMCcNRHxdgTS9m_roYwGxF6HQxIqZVwXmxRJUziFHUFxDrNuUIjCJCx6gBhPlpFbUXulB1fo2&#39;</span>
</code></pre></div></td></tr></table></div>
<h4 id="device-authorization-grant">Device Authorization Grant<a class="headerlink" href="#device-authorization-grant" title="Permanent link">&para;</a></h4>
<p>Helpers for the Device Authorization Grant are also included. To get device and user codes, read the response attributes
(including Device Code, User Code, Verification URI, etc.), then pooling the Token Endpoint:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OAuth2Client</span><span class="p">,</span>
    <span class="n">DeviceAuthorizationPoolingJob</span><span class="p">,</span>
    <span class="n">BearerToken</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">device_authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/device_authorization_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">da_resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorize_device</span><span class="p">()</span>

<span class="c1"># `da_resp` contains the Device Code, User Code, Verification URI and other info returned by the AS:</span>
<span class="n">da_resp</span><span class="o">.</span><span class="n">device_code</span>
<span class="n">da_resp</span><span class="o">.</span><span class="n">user_code</span>
<span class="n">da_resp</span><span class="o">.</span><span class="n">verification_uri</span>
<span class="n">da_resp</span><span class="o">.</span><span class="n">verification_uri_complete</span>
<span class="n">da_resp</span><span class="o">.</span><span class="n">expires_at</span>  <span class="c1"># just like for BearerToken, expiration is tracked by requests_oauth2client</span>
<span class="n">da_resp</span><span class="o">.</span><span class="n">interval</span>

<span class="c1"># Send/show the Verification Uri and User Code to the user. He must use a browser to visit that url, authenticate and</span>
<span class="c1"># input the User Code.</span>

<span class="c1"># You can then request the Token endpoint to check if the user successfully authorized your device like this:</span>
<span class="n">pool_job</span> <span class="o">=</span> <span class="n">DeviceAuthorizationPoolingJob</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">da_resp</span><span class="p">)</span>

<span class="n">resp</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">while</span> <span class="n">resp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pool_job</span><span class="p">()</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">BearerToken</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.device_authorization.DeviceAuthorizationPoolingJob">DeviceAuthorizationPoolingJob</a>
will automatically obey the pooling period. Everytime you call <code>pool_job()</code>, it will wait the appropriate number of
seconds as indicated by the AS, and will apply slow_down requests.</p>
<h5 id="as-auth-handler_2">As Auth Handler<a class="headerlink" href="#as-auth-handler_2" title="Permanent link">&para;</a></h5>
<p>Use
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2DeviceCodeAuth">OAuth2DeviceCodeAuth</a>
as auth handler to exchange a device code for an access token:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2DeviceCodeAuth</span><span class="p">,</span> <span class="n">OAuth2Client</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">device_authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/device_authorization_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">device_auth_resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorize_device</span><span class="p">()</span>

<span class="c1"># expose user_code and verification_uri or verification_uri_complete to the user</span>
<span class="n">device_auth_resp</span><span class="o">.</span><span class="n">user_code</span>
<span class="n">device_auth_resp</span><span class="o">.</span><span class="n">verification_uri</span>
<span class="n">device_auth_resp</span><span class="o">.</span><span class="n">verification_uri_complete</span>

<span class="c1"># then try to send your request with a OAuth2DeviceCodeAuth handler</span>
<span class="c1"># this will pool the token endpoint until the user authorize the device</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
    <span class="s2">&quot;https://your.protected.api/endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2DeviceCodeAuth</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">device_auth_resp</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="p">)</span>  <span class="c1"># first call will hang until the user authorizes your app and the token endpoint returns a token.</span>
</code></pre></div></td></tr></table></div>
<h4 id="client-initiated-backchannel-authentication-ciba">Client-Initiated BackChannel Authentication (CIBA)<a class="headerlink" href="#client-initiated-backchannel-authentication-ciba" title="Permanent link">&para;</a></h4>
<p>To initiate a BackChannel Authentication against the dedicated endpoint, read the response attributes, and pool the
Token Endpoint until the end-user successfully authenticates:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OAuth2Client</span><span class="p">,</span>
    <span class="n">BearerToken</span><span class="p">,</span>
    <span class="n">BackChannelAuthenticationPoolingJob</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">backchannel_authentication_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/backchannel_authorization_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">ba_resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">backchannel_authentication_request</span><span class="p">(</span>
    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;openid email profile&quot;</span><span class="p">,</span>
    <span class="n">login_hint</span><span class="o">=</span><span class="s2">&quot;user@example.net&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># `ba_resp` will contain the response attributes as returned by the AS, including an `auth_req_id`:</span>
<span class="n">ba_resp</span><span class="o">.</span><span class="n">auth_req_id</span>
<span class="n">ba_resp</span><span class="o">.</span><span class="n">expires_in</span>  <span class="c1"># decreases as times fly</span>
<span class="n">ba_resp</span><span class="o">.</span><span class="n">expires_at</span>  <span class="c1"># a datetime to keep track of the expiration date, based on the &quot;expires_in&quot; returned by the AS</span>
<span class="n">ba_resp</span><span class="o">.</span><span class="n">interval</span>  <span class="c1"># the pooling interval indicated by the AS</span>
<span class="n">ba_resp</span><span class="o">.</span><span class="n">custom</span>  <span class="c1"># if the AS respond with additional attributes, they are also accessible</span>

<span class="n">pool_job</span> <span class="o">=</span> <span class="n">BackChannelAuthenticationPoolingJob</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">ba_resp</span><span class="p">)</span>

<span class="n">resp</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">while</span> <span class="n">resp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pool_job</span><span class="p">()</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">BearerToken</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Hints by the AS to slow down pooling will automatically be obeyed.</p>
<h4 id="token-exchange">Token Exchange<a class="headerlink" href="#token-exchange" title="Permanent link">&para;</a></h4>
<p>To send a token exchange request, use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.token_exchange">OAuth2Client.token_exchange()</a>
method:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_exchange</span><span class="p">(</span>
    <span class="n">subject_token</span><span class="o">=</span><span class="s2">&quot;your_token_value&quot;</span><span class="p">,</span>
    <span class="n">subject_token_type</span><span class="o">=</span><span class="s2">&quot;urn:ietf:params:oauth:token-type:access_token&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>As with the other grant-type specific methods, you may specify additional keyword parameters, that will be passed to the
token endpoint, including any standardised attribute like <code>actor_token</code> or <code>actor_token_type</code>, or any custom parameter.
There are short names for token types, that will be automatically translated to standardised types:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_exchange</span><span class="p">(</span>
    <span class="n">subject_token</span><span class="o">=</span><span class="s2">&quot;your_token_value&quot;</span><span class="p">,</span>
    <span class="n">subject_token_type</span><span class="o">=</span><span class="s2">&quot;access_token&quot;</span><span class="p">,</span>  <span class="c1"># will be automatically replaced by &quot;urn:ietf:params:oauth:token-type:access_token&quot;</span>
    <span class="n">actor_token</span><span class="o">=</span><span class="s2">&quot;your_actor_token&quot;</span><span class="p">,</span>
    <span class="n">actor_token_type</span><span class="o">=</span><span class="s2">&quot;id_token&quot;</span><span class="p">,</span>  <span class="c1"># will be automatically replaced by &quot;urn:ietf:params:oauth:token-type:id_token&quot;</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Or to make it even easier, types can be guessed based on the supplied subject or actor token:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">BearerToken</span><span class="p">,</span> <span class="n">ClientSecretJwt</span><span class="p">,</span> <span class="n">IdToken</span><span class="p">,</span> <span class="n">OAuth2Client</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_exchange</span><span class="p">(</span>
    <span class="n">subject_token</span><span class="o">=</span><span class="n">BearerToken</span><span class="p">(</span>
        <span class="s2">&quot;your_token_value&quot;</span>
    <span class="p">),</span>  <span class="c1"># subject_token_type will be &quot;urn:ietf:params:oauth:token-type:access_token&quot;</span>
    <span class="n">actor_token</span><span class="o">=</span><span class="n">IdToken</span><span class="p">(</span>
        <span class="s2">&quot;your_actor_token&quot;</span>
    <span class="p">),</span>  <span class="c1"># actor_token_type will be &quot;urn:ietf:params:oauth:token-type:id_token&quot;</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="supported-client-authentication-methods">Supported Client Authentication Methods<a class="headerlink" href="#supported-client-authentication-methods" title="Permanent link">&para;</a></h3>
<p><code>requests_oauth2client</code> supports several client authentication methods, as defined in multiple OAuth2.x standards. You
select the appropriate method to use when initializing your <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a>, with the <code>auth</code> parameter. Once initialized,
a client will automatically use the configured authentication method every time it sends a requested to an endpoint that
requires client authentication. You don't have anything else to do afterwards.</p>
<h4 id="client-secret-basic">Client Secret Basic<a class="headerlink" href="#client-secret-basic" title="Permanent link">&para;</a></h4>
<p>With <strong>client_secret_basic</strong>, <code>client_id</code> and <code>client_secret</code> are included in clear-text in the <code>Authorization</code> header
when sending requests to the Token Endpoint. To use it, just pass a
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.ClientSecretBasic"><code>ClientSecretBasic(client_id, client_secret)</code></a>
as <code>auth</code> parameter:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretBasic</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretBasic</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="client-secret-post">Client Secret Post<a class="headerlink" href="#client-secret-post" title="Permanent link">&para;</a></h4>
<p>With <strong>client_secret_post</strong>, <code>client_id</code> and <code>client_secret</code> are included as part of the body form data. To use it, pass
a
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.ClientSecretPost"><code>ClientSecretPost(client_id, client_secret)</code></a>
as <code>auth</code> parameter. This is the default when you pass a tuple <code>(client_id, client_secret)</code> as <code>auth</code> when initializing
an <code>OAuth2Client</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretPost</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretPost</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="c1"># or</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># or</span>
<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;my_client_id&quot;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;my_client_secret&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="client-secret-jwt">Client Secret JWT<a class="headerlink" href="#client-secret-jwt" title="Permanent link">&para;</a></h4>
<p>With <strong>client_secret_jwt</strong>, the client generates an ephemeral JWT assertion including information about itself
(client_id), the AS (url of the endpoint), and an expiration date a few seconds in the future. To use it, pass a
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.ClientSecretJwt"><code>ClientSecretJwt(client_id, client_secret)</code></a>
as <code>auth</code> parameter. Assertion generation is entirely automatic, you don't have anything to do:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This method is more secure than the 2 previous, because only ephemeral credentials are transmitted, which limits the
possibility for interception and replay of the Client Secret. But that Client Secret still needs to be shared between
the AS and Client owner(s).</p>
<h4 id="private-key-jwt">Private Key JWT<a class="headerlink" href="#private-key-jwt" title="Permanent link">&para;</a></h4>
<p>With <strong>private_key_jwt</strong>, client uses a JWT assertion that is just like the one for <em>client_secret_jwt</em>, but it is
signed with an <em>asymmetric</em> key. To use it, you need a private signing key, in a <code>dict</code> that matches the JWK format, or
as an instance of <code>jwskate.Jwk</code>. The matching public key must be registered for your client on AS side. Once you have
that, using this auth method is simple with the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.PrivateKeyJwt"><code>PrivateKeyJwt(client_id, private_jwk)</code></a>
auth handler:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">PrivateKeyJwt</span>

<span class="n">private_jwk</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;mykid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dp&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dq&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qi&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">PrivateKeyJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">private_jwk</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># or</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">private_jwk</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># or</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">private_jwk</span><span class="o">=</span><span class="n">private_jwk</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This method can be considered more secure than those relying on a client secret, because only ephemeral credentials are
sent over the wire, and it uses asymmetric cryptography: the signing key is generated by the client, and only the public
key is known by the AS. Transmitting that public key between owner(s) of the client and of the AS is much easier than
transmitting the Client Secret, which is a shared key that must be considered as confidential.</p>
<h4 id="none">None<a class="headerlink" href="#none" title="Permanent link">&para;</a></h4>
<p>The latest Client Authentication Method, <strong>none</strong>, is for Public Clients which do not authenticate to the Token
Endpoint. Those clients only include their <code>client_id</code> in body form data, without any authentication credentials. Use
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.PublicApp"><code>PublicApp(client_id)</code></a>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">PublicApp</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">PublicApp</span><span class="p">(</span><span class="s2">&quot;app_client_id&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="token-revocation">Token Revocation<a class="headerlink" href="#token-revocation" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> can send revocation requests to a Revocation Endpoint. You need to provide a Revocation Endpoint URI when
creating the <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a>. The
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.revoke_token">OAuth2Client.revoke_token()</a>
method and its specialized aliases
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.revoke_access_token">.revoke_access_token()</a>
and
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.revoke_refresh_token">.revoke_refresh_token()</a>
are then available:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">revocation_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/revocation_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">oauth2client</span><span class="o">.</span><span class="n">revoke_token</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">,</span> <span class="n">token_type_hint</span><span class="o">=</span><span class="s2">&quot;access_token&quot;</span><span class="p">)</span>
<span class="n">oauth2client</span><span class="o">.</span><span class="n">revoke_access_token</span><span class="p">(</span>
    <span class="s2">&quot;mytoken&quot;</span>
<span class="p">)</span>  <span class="c1"># will automatically add token_type_hint=access_token</span>
<span class="n">oauth2client</span><span class="o">.</span><span class="n">revoke_refresh_token</span><span class="p">(</span>
    <span class="s2">&quot;mytoken&quot;</span>
<span class="p">)</span>  <span class="c1"># will automatically add token_type_hint=refresh_token</span>
</code></pre></div></td></tr></table></div>
<p>Because Revocation Endpoints usually don't return meaningful responses, those methods return a boolean. This boolean
indicates that a request was successfully sent and no error was returned. If the Authorization Server returns a
non-successful HTTP code, but no standardised error message, it will return <code>False</code>. If the Authorization Server
actually returns a standardised error, an exception will be raised instead, like the other methods from <code>OAuth2Client</code>.</p>
<h3 id="token-introspection">Token Introspection<a class="headerlink" href="#token-introspection" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> can send requests to a Token Introspection Endpoint. You need to provide an Introspection Endpoint URI
when creating the <code>OAuth2Client</code>. The
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.instrospect_token()">OAuth2Client.introspect_token()</a>
method is then available:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">introspection_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/introspection_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">introspect_token</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">,</span> <span class="n">token_type_hint</span><span class="o">=</span><span class="s2">&quot;access_token&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>It returns whatever data is returned by the introspection endpoint (if it is a JSON, its content is returned decoded).</p>
<h3 id="userinfo-requests">UserInfo Requests<a class="headerlink" href="#userinfo-requests" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> can send requests to an UserInfo Endpoint. You need to provide an UserInfo Endpoint URI when creating the
<code>OAuth2Client</code>. The
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.userinfo">OAuth2Client.userinfo()</a>)
method is then available:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
    <span class="n">userinfo_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/userinfo_endpoint&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">userinfo</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>It returns whatever data is returned by the userinfo endpoint (if it is a JSON, its content is returned decoded).</p>
<h3 id="initializing-an-oauth2client-from-a-discovery-document">Initializing an <code>OAuth2Client</code> from a discovery document<a class="headerlink" href="#initializing-an-oauth2client-from-a-discovery-document" title="Permanent link">&para;</a></h3>
<p>You can initialize an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> with the endpoint URIs mentioned in a standardised discovery document with the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.from_discovery_document">OAuth2Client.from_discovery_endpoint()</a>
class method:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the.as/.well-known/openid-configuration&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># OR, if you know the issuer value</span>
<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://url.to.the.as&quot;</span><span class="p">,</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>This will fetch the document from the specified URI, then will decode it and initialize an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> pointing to
the appropriate endpoint URIs.</p>
<p>If using the <code>issuer</code> keyword arg, the URI to the discovery endpoint will be deduced from that identifier, and a check
will be made that the <code>issuer</code> from the retrieved metadata document matches that value.</p>
<h3 id="specialized-api-client">Specialized API Client<a class="headerlink" href="#specialized-api-client" title="Permanent link">&para;</a></h3>
<p>Using APIs usually involves multiple endpoints under the same root url, with a common authentication method. To make it
easier, <code>requests_oauth2client</code> includes a <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session">requests.Session</a> wrapper called <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a>, which takes the root API url
as parameter on initialization. You can then send requests to different endpoints by passing their relative path instead
of the full url. <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> also accepts an <code>auth</code> parameter with an AuthHandler. You can pass any of the OAuth2 Auth
Handler from this module, or any <a href="https://requests.readthedocs.io/en/latest/">requests</a>-compatible
<a href="https://requests.readthedocs.io/en/latest/user/advanced/#custom-authentication">Authentication Handler</a>. Which makes it
very easy to call APIs that are protected with an OAuth2 Client Credentials Grant:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span>

<span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
    <span class="s2">&quot;https://myapi.local/root&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span><span class="n">oauth2client</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># will actually send a GET to https://myapi.local/root/resource/foo</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/resource/foo&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Note that <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> will never send requests "outside" its configured root url. The leading <code>/</code> in <code>/resource</code> above
is optional. A leading <code>/</code> will not "reset" the url path to root, which means that you can also write the relative path
without the <code>/</code> and it will automatically be included:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resource/foo&quot;</span><span class="p">)</span>  <span class="c1"># will also send a GET to https://myapi.local/root/resource/foo</span>
</code></pre></div></td></tr></table></div>
<p>You may also pass the path as an iterable of strings (or string-able objects), in which case they will be joined with a
<code>/</code> and appended to the url path:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># will send a GET to https://myapi.local/root/resource/foo</span>
<span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s2">&quot;resource&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">])</span>
<span class="c1"># will send a GET to https://myapi.local/root/users/1234/details</span>
<span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="mi">1234</span><span class="p">,</span> <span class="s2">&quot;details&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
<p>You can also use a syntax based on <code>__getattr__</code> or <code>__getitem__</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">api</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># will send a GET to https://myapi.local/root/resource</span>
<span class="n">api</span><span class="p">[</span><span class="s2">&quot;my-resource&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># will send a GET to https://myapi.local/root/my-resource</span>
</code></pre></div></td></tr></table></div>
<p>Both <code>__getattr__</code> and <code>__getitem__</code> return a new <code>ApiClient</code> initialised on the new base_url. So you can easily call
multiple sub-resources on the same API this way:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">ApiClient</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span><span class="s2">&quot;https://myapi.local&quot;</span><span class="p">)</span>
<span class="n">users_api</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">users</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">users_api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;userid&quot;</span><span class="p">)</span>  <span class="c1"># GET https://myapi.local/users/userid</span>
<span class="n">other_user</span> <span class="o">=</span> <span class="n">users_api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;other_userid&quot;</span><span class="p">)</span>  <span class="c1"># GET https://myapi.local/users/other_userid</span>
<span class="n">resources_api</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">resources</span>
<span class="n">resources</span> <span class="o">=</span> <span class="n">resources_api</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># GET https://myapi.local/resources</span>
</code></pre></div></td></tr></table></div>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> will, by default, raise exceptions whenever a request returns an error status. You can disable that by
passing <code>raise_for_status=False</code> when initializing your <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">ApiClient</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
    <span class="s2">&quot;http://httpstat.us&quot;</span><span class="p">,</span> <span class="n">raise_for_status</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>  <span class="c1"># raise_for_status defaults to True</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;500&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">resp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="c1"># without raise_for_status=False, a requests.exceptions.HTTPError exception would be raised instead</span>
</code></pre></div></td></tr></table></div>
<p>You may override this at request time:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># raise_for_status at request-time overrides the value defined at init-time</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;500&quot;</span><span class="p">,</span> <span class="n">raise_for_status</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>You can access the underlying <code>requests.Session</code> with the session attribute, and you can provide an already existing and
configured <code>Session</code> instance at init time:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests_oauth2client</span> <span class="kn">import</span> <span class="n">ApiClient</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;https&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:3128&quot;</span><span class="p">}</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span><span class="s2">&quot;https://myapi.local/resource&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">api</span><span class="o">.</span><span class="n">session</span> <span class="o">==</span> <span class="n">session</span>
</code></pre></div></td></tr></table></div>
<h3 id="vendor-specific-clients">Vendor-Specific clients<a class="headerlink" href="#vendor-specific-clients" title="Permanent link">&para;</a></h3>
<p><code>requests_oauth2client</code> is flexible enough to handle most use cases, so you should be able to use any AS by any vendor
as long as it supports OAuth 2.0.</p>
<p>You can however create a subclass of <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> or <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> to make it easier to use with specific Authorization
Servers or APIs. <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> has several extensibility points in the form of methods like
<code>OAuth2Client.parse_token_response()</code>, <code>OAuth2Client.on_token_error()</code> that implement response parsing, error handling,
etc.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">requests_oauth2client.vendor_specific</span> <span class="kn">import</span> <span class="n">Auth0</span>

<span class="n">a0client</span> <span class="o">=</span> <span class="n">Auth0</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
    <span class="s2">&quot;mytenant.eu&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span>
<span class="p">)</span>
<span class="c1"># this will automatically initialize the token endpoint to https://mytenant.eu.auth0.com/oauth/token</span>
<span class="c1"># and other endpoints accordingly</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">a0client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">audience</span><span class="o">=</span><span class="s2">&quot;audience&quot;</span><span class="p">)</span>

<span class="c1"># this is a wrapper around Auth0 Management API</span>
<span class="n">a0mgmt</span> <span class="o">=</span> <span class="n">Auth0</span><span class="o">.</span><span class="n">management_api_client</span><span class="p">(</span>
    <span class="s2">&quot;mytenant.eu&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span>
<span class="p">)</span>
<span class="n">myusers</span> <span class="o">=</span> <span class="n">a0mgmt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<!-- END INCLUDE -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
        
          
          <a href="installation/" class="md-footer__link md-footer__link--next" aria-label="Next: Installation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Installation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/guillp/requests_oauth2client" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:guill.p.linux@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.indexes", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "navigation.footer", "content.code.copy", "content.action.view"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.dd8806f2.min.js"></script>
      
    
  </body>
</html>