
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="installation/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>requests_oauth2client</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="requests_oauth2client" class="md-header__button md-logo" aria-label="requests_oauth2client" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            requests_oauth2client
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/guillp/requests_oauth2client" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    requests_oauth2client
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="installation/" class="md-tabs__link">
        
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="api/" class="md-tabs__link">
        
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="contributing/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="requests_oauth2client" class="md-nav__button md-logo" aria-label="requests_oauth2client" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    requests_oauth2client
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/guillp/requests_oauth2client" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    requests_oauth2client
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calling-apis-with-access-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Calling APIs with Access Tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-an-oauth2client" class="md-nav__link">
    <span class="md-ellipsis">
      Using an OAuth2Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtaining-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Obtaining tokens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Obtaining tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-oauth2client-as-a-requests-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Using OAuth2Client as a requests Auth Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-credentials-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Client Credentials grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Credentials grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-code-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Code Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization Code Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-authorization-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Authorization Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-the-authorization-response" class="md-nav__link">
    <span class="md-ellipsis">
      Validating the Authorization Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exchanging-code-for-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Exchanging code for tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_1" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#note-on-authorizationrequest" class="md-nav__link">
    <span class="md-ellipsis">
      Note on AuthorizationRequest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-authorization-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Device Authorization Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Device Authorization Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_2" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-initiated-backchannel-authentication-ciba" class="md-nav__link">
    <span class="md-ellipsis">
      Client-Initiated BackChannel Authentication (CIBA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      Token Exchange
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-client-authentication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Client Authentication Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Client Authentication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-secret-basic" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-post" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Post
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-key-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Private Key JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#none" class="md-nav__link">
    <span class="md-ellipsis">
      None
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      Token Revocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-introspection" class="md-nav__link">
    <span class="md-ellipsis">
      Token Introspection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo-requests" class="md-nav__link">
    <span class="md-ellipsis">
      UserInfo Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initializing-an-oauth2client-from-a-discovery-document" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing an OAuth2Client from a discovery document
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-dpop" class="md-nav__link">
    <span class="md-ellipsis">
      Using DPoP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using DPoP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-dpoptoken" class="md-nav__link">
    <span class="md-ellipsis">
      About DPoPToken
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-your-own-proof-signature-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Choosing your own proof signature keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hooking-into-dpop-key-and-proof-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Hooking into DPoP key and proof generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-dpop-nonces" class="md-nav__link">
    <span class="md-ellipsis">
      About DPoP nonces
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specialized-api-client" class="md-nav__link">
    <span class="md-ellipsis">
      Specialized API Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vendor-specific-clients" class="md-nav__link">
    <span class="md-ellipsis">
      Vendor-Specific clients
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calling-apis-with-access-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Calling APIs with Access Tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-an-oauth2client" class="md-nav__link">
    <span class="md-ellipsis">
      Using an OAuth2Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtaining-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Obtaining tokens
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Obtaining tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-oauth2client-as-a-requests-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Using OAuth2Client as a requests Auth Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-credentials-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Client Credentials grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Credentials grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-code-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Code Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization Code Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-authorization-requests" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Authorization Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-the-authorization-response" class="md-nav__link">
    <span class="md-ellipsis">
      Validating the Authorization Response
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exchanging-code-for-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Exchanging code for tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_1" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#note-on-authorizationrequest" class="md-nav__link">
    <span class="md-ellipsis">
      Note on AuthorizationRequest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-authorization-grant" class="md-nav__link">
    <span class="md-ellipsis">
      Device Authorization Grant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Device Authorization Grant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-auth-handler_2" class="md-nav__link">
    <span class="md-ellipsis">
      As Auth Handler
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-initiated-backchannel-authentication-ciba" class="md-nav__link">
    <span class="md-ellipsis">
      Client-Initiated BackChannel Authentication (CIBA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      Token Exchange
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-client-authentication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Client Authentication Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Client Authentication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-secret-basic" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-post" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret Post
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-secret-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Client Secret JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#private-key-jwt" class="md-nav__link">
    <span class="md-ellipsis">
      Private Key JWT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#none" class="md-nav__link">
    <span class="md-ellipsis">
      None
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      Token Revocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-introspection" class="md-nav__link">
    <span class="md-ellipsis">
      Token Introspection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo-requests" class="md-nav__link">
    <span class="md-ellipsis">
      UserInfo Requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initializing-an-oauth2client-from-a-discovery-document" class="md-nav__link">
    <span class="md-ellipsis">
      Initializing an OAuth2Client from a discovery document
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-dpop" class="md-nav__link">
    <span class="md-ellipsis">
      Using DPoP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using DPoP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-dpoptoken" class="md-nav__link">
    <span class="md-ellipsis">
      About DPoPToken
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-your-own-proof-signature-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Choosing your own proof signature keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hooking-into-dpop-key-and-proof-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Hooking into DPoP key and proof generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-dpop-nonces" class="md-nav__link">
    <span class="md-ellipsis">
      About DPoP nonces
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specialized-api-client" class="md-nav__link">
    <span class="md-ellipsis">
      Specialized API Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vendor-specific-clients" class="md-nav__link">
    <span class="md-ellipsis">
      Vendor-Specific clients
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/guillp/requests_oauth2client/raw/master/docs/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Home</h1>

<p><code>requests_oauth2client</code> is an OAuth 2.x client for Python, able to obtain, refresh and revoke tokens from any
OAuth2.x/OIDC compliant Authorization Server. It sits upon and extends the famous <a href="https://requests.readthedocs.io/en/latest/">requests</a> HTTP client module.</p>
<p>It can act as an <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0</a> /
<a href="https://datatracker.ietf.org/doc/draft-ietf-oauth-v2-1">2.1</a> client, to automatically get and renew Access Tokens,
based on the
<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-v2-1-07.html#name-client-credentials">Client Credentials</a>,
<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-v2-1-07.html#name-authorization-code">Authorization Code</a>,
<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-v2-1-07.html#name-refresh-token">Refresh token</a>,
<a href="https://www.rfc-editor.org/rfc/rfc8693.html">Token Exchange</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7523.html#section-2.1">JWT Bearer</a>,
<a href="https://www.rfc-editor.org/rfc/rfc8628.html">Device Authorization</a>,
<a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.3">Resource Owner Password</a> or
<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">CIBA</a> grants.
Additional grant types are easy to add if needed.</p>
<p>It also supports <a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect 1.0</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7636.html">PKCE</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7523.html#section-2.2">Client Assertions</a>,
<a href="https://www.rfc-editor.org/rfc/rfc7009.html">Token Revocation</a> and
<a href="https://www.rfc-editor.org/rfc/rfc7662.html">Introspection</a>,
<a href="https://www.rfc-editor.org/rfc/rfc8707.html">Resource Indicators</a>,
<a href="https://datatracker.ietf.org/doc/rfc9101/">JWT-secured Authorization Requests</a>,
<a href="https://datatracker.ietf.org/doc/rfc9126/">Pushed Authorization Requests</a>,
<a href="https://www.rfc-editor.org/rfc/rfc9207.html">Authorization Server Issuer Identification</a>,
<a href="https://www.rfc-editor.org/rfc/rfc9449.html">Demonstrating Proof of Possession</a>,
as well as using custom params to any endpoint, and other important features that are often overlooked or needlessly
complex in other client libraries.</p>
<p>And it also includes a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">wrapper</a> around <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session">requests.Session</a> that makes it super easy to use REST-style APIs,
with or without OAuth 2.x.</p>
<p>Please note that despite the name, this library has no relationship with Google
<a href="https://github.com/googleapis/oauth2client">oauth2client</a> library.</p>
<p><a href="https://www.python.org/"><img alt="made-with-python" src="https://img.shields.io/badge/Made%20with-Python-1f425f.svg" /></a>
<a href="https://pypi.org/project/requests_oauth2client/"><img alt="PyPi version" src="https://img.shields.io/pypi/v/requests_oauth2client" /></a>
<a href="https://pepy.tech/project/requests_oauth2client"><img alt="Downloads" src="https://static.pepy.tech/badge/requests_oauth2client/month" /></a>
<a href="https://pypi.org/project/requests_oauth2client"><img alt="Supported Versions" src="https://img.shields.io/pypi/pyversions/requests_oauth2client.svg" /></a>
<a href="https://pypi.com/project/requests_oauth2client/"><img alt="PyPi license" src="https://badgen.net/pypi/license/requests_oauth2client/" /></a>
<a href="https://pypi.python.org/pypi/requests_oauth2client/"><img alt="PyPI status" src="https://img.shields.io/pypi/status/requests_oauth2client.svg" /></a>
<a href="https://github.com/guillp/requests_oauth2client/commit/"><img alt="GitHub commits" src="https://badgen.net/github/commits/guillp/requests_oauth2client" /></a>
<a href="https://github.com/guillp/requests_oauth2client/commit/"><img alt="GitHub latest commit" src="https://badgen.net/github/last-commit/guillp/requests_oauth2client" /></a>
<a href="https://github.com/astral-sh/ruff"><img alt="Ruff" src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/ruff/main/assets/badge/v2.json" /></a></p>
<h2 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h2>
<p>Full module documentation is available at https://guillp.github.io/requests_oauth2client/.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p><code>requests_oauth2client</code> is <a href="https://pypi.org/project/requests-oauth2client/">available from PyPi</a>, so installing it is
as easy as:</p>
<div class="language-shell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>requests_oauth2client
</span></code></pre></div></td></tr></table></div>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Everything from <code>requests_oauth2client</code> is available from the root module, so you can import it like this:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span></code></pre></div></td></tr></table></div>
<p>Or you can import individual objects from this package as usual. Note that importing <code>*</code> automatically imports
<code>requests</code>, so no need to import it yourself.</p>
<h3 id="calling-apis-with-access-tokens">Calling APIs with Access Tokens<a class="headerlink" href="#calling-apis-with-access-tokens" title="Permanent link">&para;</a></h3>
<p>If you have already obtained an access token for the API you want to call, you can convert it to an instance of
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a>. Instances of this class work as a <code>requests</code> compatible auth handler.</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">BearerToken</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="n">token</span> <span class="o">=</span> <span class="n">BearerToken</span><span class="p">(</span><span class="s2">&quot;my_access_token&quot;</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://my.protected.api/endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This authentication handler will add a <code>Authorization: Bearer &lt;my_access_token&gt;</code> header in the request, with your access
token value, properly formatted according to <a href="https://datatracker.ietf.org/doc/html/rfc6750#section-2.1">RFC6750</a>.</p>
<h3 id="using-an-oauth2client">Using an OAuth2Client<a class="headerlink" href="#using-an-oauth2client" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> offers several methods that implement the communication to the various endpoints that are standardised by
OAuth 2.0 and its extensions. These endpoints include the Token Endpoint, Revocation, Introspection, UserInfo,
BackChannel Authentication and Device Authorization Endpoints.</p>
<p>You must provide the URLs for these endpoints if you intend to use them. Otherwise, only the Token Endpoint is mandatory
to initialize an <code>OAuth2Client</code>.</p>
<p>To initialize an instance of <code>OAuth2Client</code>, you only need the Token Endpoint URI from your Authorization Server (AS),
and the credentials for your application, typically a <code>client_id</code> and a <code>client_secret</code>, usually also provided by the
AS:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;my_client_id&quot;</span><span class="p">,</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a>    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;my_client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>The Token Endpoint is the only endpoint that is mandatory to obtain tokens. Credentials are used to authenticate the
client everytime it sends a request to its Authorization Server. Usually, these are a static Client ID and Secret, which
are the equivalent of a username and a password, but meant for an application instead of for a human user. The default
authentication method used by <code>OAuth2Client</code> is <em>Client Secret Post</em>, but other standardized methods such as <em>Client
Secret Basic</em>, <em>Client Secret JWT</em> or <em>Private Key JWT</em> are supported as well. See
<a href="../#supported-client-authentication-methods">more about client authentication methods below</a>.</p>
<p>Instead of providing each endpoint URL yourself, you may also
<a href="../#initializing-an-oauth2client-from-a-discovery-document">use the AS metadata endpoint URI</a>, or the document data
itself, to initialize your OAuth 2.0 client with the appropriate endpoints.</p>
<h3 id="obtaining-tokens">Obtaining tokens<a class="headerlink" href="#obtaining-tokens" title="Permanent link">&para;</a></h3>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> has dedicated methods to send requests to the Token Endpoint using different standardized grants. Since
the Token Endpoint URL and Client Authentication Method are already declared for the client at initialization, the only
required parameters for these methods are those that will be sent in the request to the Token Endpoint.</p>
<p>These methods directly return a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> if the request is successful, or raise an exception if it fails.
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> contains all the data returned by the Token Endpoint, including the Access Token. It will also:</p>
<ul>
<li>Keep track of the Access Token expiration date (based on the <code>expires_in</code> hint as returned by the AS). This date is
  accessible with the <code>expires_at</code> attribute.</li>
<li>Contain the Refresh Token, if returned by the AS, accessible with the <code>refresh_token</code> attribute.</li>
<li>Contain the ID Token, if returned by the AS, accessible with the <code>id_token</code> attribute (typically available when using
  the Authorization Code flow).</li>
<li>Keep track of other associated metadata as well, also accessible as attributes with the same name:
  <code>token.custom_attr</code>, or with subscription syntax <code>token["my.custom.attr"]</code>.</li>
</ul>
<p>You can create such a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> yourself if needed:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">BearerToken</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">bearer_token</span> <span class="o">=</span> <span class="n">BearerToken</span><span class="p">(</span><span class="n">access_token</span><span class="o">=</span><span class="s2">&quot;an_access_token&quot;</span><span class="p">,</span> <span class="n">expires_in</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">bearer_token</span><span class="p">)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1"># {&#39;access_token&#39;: &#39;an_access_token&#39;,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="c1">#  &#39;expires_in&#39;: 55,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1">#  &#39;token_type&#39;: &#39;Bearer&#39;}</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">bearer_token</span><span class="o">.</span><span class="n">expires_at</span><span class="p">)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="c1"># datetime.datetime(2021, 8, 20, 9, 56, 59, 498793)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="k">assert</span> <span class="ow">not</span> <span class="n">bearer_token</span><span class="o">.</span><span class="n">is_expired</span><span class="p">()</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">bearer_token</span><span class="o">.</span><span class="n">expires_in</span><span class="p">)</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="c1"># 40</span>
</span></code></pre></div></td></tr></table></div>
<p>Note that the <code>expires_in</code> indicator here is not static. It keeps track of the token lifetime, in seconds, and is
calculated as the time flies. The actual static expiration date is accessible with the <code>expires_at</code> property. You can
check if a token is expired with
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken.is_expired">bearer_token.is_expired()</a>.</p>
<p>You can use a <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.tokens.BearerToken">BearerToken</a> instance anywhere you can use an access_token as string.</p>
<h4 id="using-oauth2client-as-a-requests-auth-handler">Using OAuth2Client as a requests Auth Handler<a class="headerlink" href="#using-oauth2client-as-a-requests-auth-handler" title="Permanent link">&para;</a></h4>
<p>Using <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> directly is useful for testing or debugging OAuth2.x flows, but it may not be suitable for actual
applications where tokens must be obtained, used during their lifetime, then obtained again or refreshed once they are
expired. <code>requests_oauth2client</code> contains several <a href="https://requests.readthedocs.io/en/latest/">requests</a> compatible Auth Handlers (as subclasses of
<a href="https://requests.readthedocs.io/en/latest/user/advanced/#custom-authentication">requests.auth.AuthBase</a>), that will
take care of obtaining tokens when required, then will cache those tokens until they are expired, and will obtain new
ones (or refresh them, when possible), once the initial token is expired. Those are best used with a <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session">requests.Session</a>,
or an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a>, which is a wrapper around <code>Session</code> with a few enhancements as described below.</p>
<h4 id="client-credentials-grant">Client Credentials grant<a class="headerlink" href="#client-credentials-grant" title="Permanent link">&para;</a></h4>
<p>To send a request using the Client Credentials grant, use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.client_credentials">.client_credentials()</a>
method, providing the necessary parameters as keyword arguments in the token request.</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a>    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="p">)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">)</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1"># or, if your AS uses resource indicator:</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;https://myapi.local&quot;</span><span class="p">)</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="c1"># or, if your AS uses &#39;audience&#39; as parameter to identify the requested API (Auth0 style):</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">audience</span><span class="o">=</span><span class="s2">&quot;https://myapi.local&quot;</span><span class="p">)</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="c1"># or, if your AS uses custom parameters:</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span> <span class="n">custom_param</span><span class="o">=</span><span class="s2">&quot;custom_value&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Parameters such as <code>scope</code>, <code>resource</code>, or <code>audience</code>, as well as any other required parameters by the Authorization
Server (AS), can be passed as keyword parameters. These parameters will be included in the token request sent to the AS.
Please note that none of those parameters are mandatory at the client level, but some might be required by your AS to
fulfill your request.</p>
<h5 id="as-auth-handler">As Auth Handler<a class="headerlink" href="#as-auth-handler" title="Permanent link">&para;</a></h5>
<p>You can use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2ClientCredentialsAuth">OAuth2ClientCredentialsAuth</a>
auth handler. It takes an <code>OAuth2Client</code> as parameter, and the additional kwargs to pass to the token endpoint:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a>    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="n">auth</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a>    <span class="n">oauth2client</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;https://myapi.local&quot;</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="p">)</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="c1"># use it like this:</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://myapi.local/resource&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">auth</span><span class="p">)</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="c1"># or like this:</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="n">session</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">auth</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20"></a>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://myapi.local/resource&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Once again, extra parameters such as <code>scope</code>, <code>resource</code> or <code>audience</code> are allowed if required.</p>
<p>When you send your first request,
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2ClientCredentialsAuth">OAuth2ClientCredentialsAuth</a>
will automatically retrieve an access token from the AS using the Client Credentials grant, then will include it in the
request. Next requests will use the same token, as long as it is valid. A new token will be automatically retrieved once
the previous one is expired.</p>
<p>You can configure a leeway, which is a period of time before the actual expiration, in seconds, when a new token will be
obtained. This may help getting continuous access to the API when the client and API clocks are slightly out of sync.
Use the parameter <code>leeway</code> to <code>OAuth2ClientCredentialsAuth</code>:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2ClientCredentialsAuth</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="n">auth</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>    <span class="n">oauth2client</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;myscope&quot;</span><span class="p">,</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>    <span class="n">leeway</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="authorization-code-grant">Authorization Code Grant<a class="headerlink" href="#authorization-code-grant" title="Permanent link">&para;</a></h4>
<p>Obtaining tokens using the Authorization code grant is made in 3 steps:</p>
<ol>
<li>your application must open a specific url called the <em>Authentication Request</em> in a browser.</li>
<li>your application must obtain and validate the <em>Authorization Response</em>, which is a redirection back to your
   application that contains an <em>Authorization Code</em> as parameter. This redirect back (often called "callback") is
   initiated by the Authorization Server after any necessary interaction with the user is complete (Registration, Login,
   Profile completion, Multi-Factor Authentication, Authorization, Consent, etc.)</li>
<li>your application must then exchange this Authorization Code for an <em>Access Token</em>, with a request to the Token
   Endpoint.</li>
</ol>
<p>Using an <code>OAuth2Client</code> will help you with all those steps, as described below.</p>
<h5 id="generating-authorization-requests">Generating Authorization Requests<a class="headerlink" href="#generating-authorization-requests" title="Permanent link">&para;</a></h5>
<p>To be able to use the Authorization Code grant, you need 2 (optionally 3) URIs:</p>
<ul>
<li>the URL for Authorization Endpoint, which is the url where you must send your Authorization Requests</li>
<li>the Redirect URI, which is the url pointing to your application, where the Authorization Server will reply with
  Authorization Response</li>
<li>optionally, the issuer identifier, if your AS uses
  <a href="https://www.rfc-editor.org/rfc/rfc9207.html">Issuer Identification</a>.</li>
</ul>
<p>You can declare those URIs when initializing your <code>OAuth2Client</code> instance, or you can
<a href="../#initializing-an-oauth2client-from-a-discovery-document">use the AS discovery endpoint</a> to initialize those URLs
automatically. Then you can generate valid Authorization Requests by calling the method <code>.authorization_request()</code>, with
the request specific parameters, such as <code>scope</code>, <code>state</code>, <code>nonce</code> as parameter:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endoint&quot;</span><span class="p">,</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>    <span class="n">authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/authorization_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>    <span class="n">redirect_uri</span><span class="o">=</span><span class="s2">&quot;https://url.to.my.application/redirect_uri&quot;</span><span class="p">,</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a>    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="p">)</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="n">az_request</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorization_request</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;openid email profile&quot;</span><span class="p">)</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">az_request</span><span class="p">)</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="c1"># this will look like this, with line feeds for display purposes only:</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="c1"># https://url.to.the.as/authorization_endpoint</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="c1"># ?client_id=client_id</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="c1"># &amp;redirect_uri=https%3A%2F%2Furl.to.my.application%2Fredirect_uri</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="c1"># &amp;response_type=code</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="c1"># &amp;scope=openid+email+profile</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="c1"># &amp;state=FBx9mWeLwoKGgG76vhi6v61-4mgxmgZhtWIa7aTffdY</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="c1"># &amp;nonce=iHZJokhkGOAojff1tdknRyz9mPZyy5vq9JDlVaUHyqk</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="c1"># &amp;code_challenge=TG7qgdyKnwUPuoQ6NNJRlLMoHbeVmJlB8g0VOcfQEkc</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="c1"># &amp;code_challenge_method=S256</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24"></a>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="c1"># you can send the user to that url with:</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="kn">import</span><span class="w"> </span><span class="nn">webbrowser</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27"></a>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">az_request</span><span class="o">.</span><span class="n">uri</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Note that the <code>state</code>, <code>nonce</code> and <code>code_challenge</code> parameters are generated with secure random values by default.
Should you wish to use your own values, you can pass them as parameters to <code>OAuth2Client.authorization_request()</code>. For
PKCE, you need to pass your generated <code>code_verifier</code>, and the <code>code_challenge</code> will automatically be derived from it.
If you want to disable PKCE, you can pass <code>code_challenge_method=None</code> when initializing your <code>OAuth2Client</code>.</p>
<h5 id="validating-the-authorization-response">Validating the Authorization Response<a class="headerlink" href="#validating-the-authorization-response" title="Permanent link">&para;</a></h5>
<p>Once you have redirected the user browser to the Authorization Request URI, and after the user is successfully
authenticated and authorized, plus any other extra interactive step is complete, the AS will respond with a redirection
to your redirect_uri. That is the <em>Authorization Response</em>. It contains several parameters that must be retrieved by
your client. The <em>Authorization Code</em> is one of those parameters, but you must also validate that the <em>state</em> matches
your request; if using <a href="https://www.rfc-editor.org/rfc/rfc9207.html">AS Issuer Identification</a>, you must also validate
that the issuer matches what is expected. You can do this with:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span>
<span class="normal"><a href="#__codelineno-9-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1"># using the `az_request` as defined above</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="n">response_uri</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a>    <span class="s2">&quot;Please enter the full url and/or params obtained on the redirect_uri: &quot;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="p">)</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="c1"># say the callback url is https://url.to.my.application/redirect_uri?code=an_az_code&amp;state=FBx9mWeLwoKGgG76vhi6v61-4mgxmgZhtWIa7aTffdY&amp;issuer=https://url.to.the.as</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="n">az_response</span> <span class="o">=</span> <span class="n">az_request</span><span class="o">.</span><span class="n">validate_callback</span><span class="p">(</span><span class="n">response_uri</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This <code>auth_response</code> is an <code>AuthorizationResponse</code> instance and contains everything that is needed for your application
to complete the authentication and get its tokens from the AS.</p>
<h5 id="exchanging-code-for-tokens">Exchanging code for tokens<a class="headerlink" href="#exchanging-code-for-tokens" title="Permanent link">&para;</a></h5>
<p>Once you have obtained the AS response, containing an authorization code, your application must exchange it for actual
Token(s).</p>
<p>To exchange a code for Access and/or ID tokens, use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.authorization_code">OAuth2Client.authorization_code()</a>
method. If you have obtained an AuthorizationResponse as described above, you can simply do:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">authorization_code</span><span class="p">(</span><span class="n">az_response</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This will automatically include the <code>code</code>, <code>redirect_uri</code> and <code>code_verifier</code> parameters in the Token Request, as
expected by the AS. You may include extra parameters if required, or you may pass your own parameters, without using an
<code>AuthorizationResponse</code> instance, like this:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">authorization_code</span><span class="p">(</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>    <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a>    <span class="n">code_verifier</span><span class="o">=</span><span class="n">code_verifier</span><span class="p">,</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a>    <span class="n">redirect_uri</span><span class="o">=</span><span class="n">redirect_uri</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a>    <span class="n">custom_param</span><span class="o">=</span><span class="n">custom_value</span><span class="p">,</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h5 id="as-auth-handler_1">As Auth Handler<a class="headerlink" href="#as-auth-handler_1" title="Permanent link">&para;</a></h5>
<p>The
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2AuthorizationCodeAuth">OAuth2AuthorizationCodeAuth</a>
handler takes an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> and an authorization code as parameter, plus whatever additional keyword parameters are
required by your Authorization Server:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2AuthorizationCodeAuth</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>    <span class="n">authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/authorization_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a>    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="p">)</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="n">api_client</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10"></a>    <span class="s2">&quot;https://your.protected.api/endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2AuthorizationCodeAuth</span><span class="p">(</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12"></a>        <span class="n">oauth2client</span><span class="p">,</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13"></a>        <span class="s2">&quot;my_authorization_code&quot;</span><span class="p">,</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14"></a>    <span class="p">),</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="p">)</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16"></a>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="c1"># any request using api_client will trigger exchanging the code for an access_token, which is then cached, and refreshed later if needed</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">})</span>
</span></code></pre></div></td></tr></table></div>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2AuthorizationCodeAuth">OAuth2AuthorizationCodeAuth</a>
will take care of refreshing the token automatically once it is expired, using the refresh token, if available.</p>
<h4 id="note-on-authorizationrequest">Note on AuthorizationRequest<a class="headerlink" href="#note-on-authorizationrequest" title="Permanent link">&para;</a></h4>
<p>Authorization Requests generated by <code>OAuth2Client.authorization_request()</code> are instance of the class
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.authorization_request.AuthorizationRequest"><code>AuthorizationRequest</code></a>.
You can also use that class directly to generate your requests, but in that case you need to supply your Authorization
Endpoint URI, your <code>client_id</code>, <code>redirect_uri</code>, etc. You can access every parameter from an <code>AuthorizationRequest</code>
instance, as well as the generated <code>code_verifier</code>, as attributes of this instance. Once an Authorization Request URL is
generated, it your application responsibility to redirect or otherwise send the user to that URL. You may use the
<code>webbrowser</code> module from Python standard library to do so. Here is an example for generating Authorization Requests:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">AuthorizationRequest</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="n">az_request</span> <span class="o">=</span> <span class="n">AuthorizationRequest</span><span class="p">(</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a>    <span class="s2">&quot;https://url.to.the/authorization_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;my_client_id&quot;</span><span class="p">,</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="n">redirect_uri</span><span class="o">=</span><span class="s2">&quot;http://localhost/callback&quot;</span><span class="p">,</span>  <span class="c1"># this redirect_uri is specific to your app</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7"></a>    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;openid email profile&quot;</span><span class="p">,</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8"></a>    <span class="c1"># extra parameters such as `resource` can be included as well if required by your AS</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9"></a>    <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;https://my.resource.local/api&quot;</span><span class="p">,</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="p">)</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="nb">print</span><span class="p">(</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12"></a>    <span class="n">az_request</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="p">)</span>  <span class="c1"># this request will look like this, with line breaks for display purposes only</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="c1"># https://url.to.the/authorization_endpoint</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="c1"># ?client_id=my_client_id</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="c1"># &amp;redirect_uri=http%3A%2F%2Flocalhost%callback</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="c1"># &amp;response_type=code</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="c1"># &amp;state=kHWL4VwcbUbtPR4mtht6yMAGG_S-ZcBh5RxI_IGDmJc</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="c1"># &amp;nonce=mSGOS1M3LYU9ncTvvutoqUR4n1EtmaC_sQ3db4dyMAc</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="c1"># &amp;scope=openid+email+profile</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="c1"># &amp;code_challenge=W3n02f6xUKoDVbmhWEWz3h780b-Ci6ucnBS_d7nogmQ</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="c1"># &amp;code_challenge_method=S256</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="c1"># &amp;resource=https%3A%2F%2Fmy.resource.local%2Fapi</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24"></a>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">az_request</span><span class="o">.</span><span class="n">code_verifier</span><span class="p">)</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26"></a><span class="c1"># &#39;gYK-ZnQfoat2bghwed7oEz--wvn4D70ksJ5GuWO9sXXygZ7PMnUlSpBmMCcNRHxdgTS9m_roYwGxF6HQxIqZVwXmxRJUziFHUFxDrNuUIjCJCx6gBhPlpFbUXulB1fo2&#39;</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="device-authorization-grant">Device Authorization Grant<a class="headerlink" href="#device-authorization-grant" title="Permanent link">&para;</a></h4>
<p>Helpers for the Device Authorization Grant are also included. To get device and user codes, read the response attributes
(including Device Code, User Code, Verification URI, etc.), then pooling the Token Endpoint:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>    <span class="n">OAuth2Client</span><span class="p">,</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>    <span class="n">DeviceAuthorizationPoolingJob</span><span class="p">,</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>    <span class="n">BearerToken</span><span class="p">,</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="p">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>    <span class="n">device_authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/device_authorization_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="p">)</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="n">da_resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorize_device</span><span class="p">()</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="c1"># `da_resp` contains the Device Code, User Code, Verification URI, and other info returned by the AS:</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="n">da_resp</span><span class="o">.</span><span class="n">device_code</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="n">da_resp</span><span class="o">.</span><span class="n">user_code</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="n">da_resp</span><span class="o">.</span><span class="n">verification_uri</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="n">da_resp</span><span class="o">.</span><span class="n">verification_uri_complete</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="n">da_resp</span><span class="o">.</span><span class="n">expires_at</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="n">da_resp</span><span class="o">.</span><span class="n">interval</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22"></a>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="c1"># Send/show the Verification Uri and User Code to the user. They must use a browser to visit that URL, authenticate, and input the User Code.</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24"></a>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="c1"># You can then request the Token endpoint to check if the user successfully authorized your device like this:</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="n">pool_job</span> <span class="o">=</span> <span class="n">DeviceAuthorizationPoolingJob</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">da_resp</span><span class="p">)</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27"></a>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="n">resp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29"></a><span class="k">while</span> <span class="n">resp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30"></a>    <span class="n">resp</span> <span class="o">=</span> <span class="n">pool_job</span><span class="p">()</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31"></a>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32"></a><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">BearerToken</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.device_authorization.DeviceAuthorizationPoolingJob">DeviceAuthorizationPoolingJob</a>
will automatically obey the pooling period. Everytime you call <code>pool_job()</code>, it will wait the appropriate number of
seconds as indicated by the AS, and will apply slow-down requests.</p>
<h5 id="as-auth-handler_2">As Auth Handler<a class="headerlink" href="#as-auth-handler_2" title="Permanent link">&para;</a></h5>
<p>Use
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.auth.OAuth2DeviceCodeAuth">OAuth2DeviceCodeAuth</a>
as auth handler to exchange a device code for an access token:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span>
<span class="normal"><a href="#__codelineno-15-22">22</a></span>
<span class="normal"><a href="#__codelineno-15-23">23</a></span>
<span class="normal"><a href="#__codelineno-15-24">24</a></span>
<span class="normal"><a href="#__codelineno-15-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2DeviceCodeAuth</span><span class="p">,</span> <span class="n">OAuth2Client</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5"></a>    <span class="n">device_authorization_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/device_authorization_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6"></a>    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="p">)</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="n">device_auth_resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">authorize_device</span><span class="p">()</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10"></a>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="c1"># expose user_code and verification_uri or verification_uri_complete to the user</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="n">device_auth_resp</span><span class="o">.</span><span class="n">user_code</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="n">device_auth_resp</span><span class="o">.</span><span class="n">verification_uri</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="n">device_auth_resp</span><span class="o">.</span><span class="n">verification_uri_complete</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15"></a>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="c1"># then try to send your request with an OAuth2DeviceCodeAuth handler</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="c1"># this will pool the token endpoint until the user authorizes the device</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="n">api_client</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19"></a>    <span class="s2">&quot;https://your.protected.api/endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2DeviceCodeAuth</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">device_auth_resp</span><span class="p">),</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="p">)</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22"></a>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24"></a>    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">}</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25"></a><span class="p">)</span>  <span class="c1"># the first call will hang until the user authorizes your app and the token endpoint returns a token.</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="client-initiated-backchannel-authentication-ciba">Client-Initiated BackChannel Authentication (CIBA)<a class="headerlink" href="#client-initiated-backchannel-authentication-ciba" title="Permanent link">&para;</a></h4>
<p>To initiate a BackChannel Authentication against the dedicated endpoint, read the response attributes and pool the Token
Endpoint until the end-user successfully authenticates:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span>
<span class="normal"><a href="#__codelineno-16-25">25</a></span>
<span class="normal"><a href="#__codelineno-16-26">26</a></span>
<span class="normal"><a href="#__codelineno-16-27">27</a></span>
<span class="normal"><a href="#__codelineno-16-28">28</a></span>
<span class="normal"><a href="#__codelineno-16-29">29</a></span>
<span class="normal"><a href="#__codelineno-16-30">30</a></span>
<span class="normal"><a href="#__codelineno-16-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>    <span class="n">OAuth2Client</span><span class="p">,</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a>    <span class="n">BearerToken</span><span class="p">,</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a>    <span class="n">BackChannelAuthenticationPoolingJob</span><span class="p">,</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a>    <span class="n">backchannel_authentication_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/backchannel_authorization_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a>    <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="p">)</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="n">ba_resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">backchannel_authentication_request</span><span class="p">(</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a>    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;openid email profile&quot;</span><span class="p">,</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a>    <span class="n">login_hint</span><span class="o">=</span><span class="s2">&quot;user@example.net&quot;</span><span class="p">,</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="p">)</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="c1"># `ba_resp` will contain the response attributes as returned by the AS, including an `auth_req_id`:</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="n">ba_resp</span><span class="o">.</span><span class="n">auth_req_id</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="n">ba_resp</span><span class="o">.</span><span class="n">expires_in</span>  <span class="c1"># decreases with time</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="n">ba_resp</span><span class="o">.</span><span class="n">expires_at</span>  <span class="c1"># a static `datetime` to keep track of the expiration date, based on the &quot;expires_in&quot; returned by the AS</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="n">ba_resp</span><span class="o">.</span><span class="n">interval</span>  <span class="c1"># the pooling interval indicated by the AS</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="n">ba_resp</span><span class="o">.</span><span class="n">custom</span>  <span class="c1"># if the AS respond with additional attributes, they are also accessible</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24"></a>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25"></a><span class="n">pool_job</span> <span class="o">=</span> <span class="n">BackChannelAuthenticationPoolingJob</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">ba_resp</span><span class="p">)</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26"></a>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27"></a><span class="n">resp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28"></a><span class="k">while</span> <span class="n">resp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29"></a>    <span class="n">resp</span> <span class="o">=</span> <span class="n">pool_job</span><span class="p">()</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30"></a>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31"></a><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">BearerToken</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Hints by the AS to slow down pooling will automatically be obeyed.</p>
<h4 id="token-exchange">Token Exchange<a class="headerlink" href="#token-exchange" title="Permanent link">&para;</a></h4>
<p>To send a token exchange request, use the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.token_exchange">OAuth2Client.token_exchange()</a>
method:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="p">)</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_exchange</span><span class="p">(</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a>    <span class="n">subject_token</span><span class="o">=</span><span class="s2">&quot;your_token_value&quot;</span><span class="p">,</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9"></a>    <span class="n">subject_token_type</span><span class="o">=</span><span class="s2">&quot;urn:ietf:params:oauth:token-type:access_token&quot;</span><span class="p">,</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>As with the other grant-type specific methods, you may specify additional keyword parameters, that will be passed to the
token endpoint, including any standardised attribute like <code>actor_token</code> or <code>actor_token_type</code>, or any custom parameter.
There are short names for token types, that will be automatically translated to standardised types:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span>
<span class="normal"><a href="#__codelineno-18-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_exchange</span><span class="p">(</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a>    <span class="n">subject_token</span><span class="o">=</span><span class="s2">&quot;your_token_value&quot;</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a>    <span class="n">subject_token_type</span><span class="o">=</span><span class="s2">&quot;access_token&quot;</span><span class="p">,</span>  <span class="c1"># will be automatically replaced by &quot;urn:ietf:params:oauth:token-type:access_token&quot;</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a>    <span class="n">actor_token</span><span class="o">=</span><span class="s2">&quot;your_actor_token&quot;</span><span class="p">,</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a>    <span class="n">actor_token_type</span><span class="o">=</span><span class="s2">&quot;id_token&quot;</span><span class="p">,</span>  <span class="c1"># will be automatically replaced by &quot;urn:ietf:params:oauth:token-type:id_token&quot;</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Or to make it even easier, types can be guessed based on the supplied subject or actor token:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">BearerToken</span><span class="p">,</span> <span class="n">ClientSecretJwt</span><span class="p">,</span> <span class="n">IdToken</span><span class="p">,</span> <span class="n">OAuth2Client</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="p">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="n">token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">token_exchange</span><span class="p">(</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a>    <span class="n">subject_token</span><span class="o">=</span><span class="n">BearerToken</span><span class="p">(</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a>        <span class="s2">&quot;your_token_value&quot;</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a>    <span class="p">),</span>  <span class="c1"># subject_token_type will be &quot;urn:ietf:params:oauth:token-type:access_token&quot;</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12"></a>    <span class="n">actor_token</span><span class="o">=</span><span class="n">IdToken</span><span class="p">(</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13"></a>        <span class="s2">&quot;your_actor_token&quot;</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14"></a>    <span class="p">),</span>  <span class="c1"># actor_token_type will be &quot;urn:ietf:params:oauth:token-type:id_token&quot;</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="supported-client-authentication-methods">Supported Client Authentication Methods<a class="headerlink" href="#supported-client-authentication-methods" title="Permanent link">&para;</a></h3>
<p><code>requests_oauth2client</code> supports several client authentication methods, as defined in multiple OAuth2.x standards. You
select the appropriate method to use when initializing your <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a>, with the <code>auth</code> parameter. Once initialized,
a client will automatically use the configured authentication method every time it sends a requested to an endpoint that
requires client authentication. You don't have anything else to do afterwards.</p>
<h4 id="client-secret-basic">Client Secret Basic<a class="headerlink" href="#client-secret-basic" title="Permanent link">&para;</a></h4>
<p>With <strong>client_secret_basic</strong>, <code>client_id</code> and <code>client_secret</code> are included in clear-text in the <code>Authorization</code> header
when sending requests to the Token Endpoint. To use it, just pass a
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.ClientSecretBasic"><code>ClientSecretBasic(client_id, client_secret)</code></a>
as <code>auth</code> parameter:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span>
<span class="normal"><a href="#__codelineno-20-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretBasic</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretBasic</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="client-secret-post">Client Secret Post<a class="headerlink" href="#client-secret-post" title="Permanent link">&para;</a></h4>
<p>With <strong>client_secret_post</strong>, <code>client_id</code> and <code>client_secret</code> are included as part of the body form data. To use it, pass
a
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.ClientSecretPost"><code>ClientSecretPost(client_id, client_secret)</code></a>
as <code>auth</code> parameter. This is the default when you pass a tuple <code>(client_id, client_secret)</code> as <code>auth</code> when initializing
an <code>OAuth2Client</code>:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretPost</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretPost</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="p">)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="c1"># or</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">)</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="p">)</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="c1"># or</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;my_client_id&quot;</span><span class="p">,</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15"></a>    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;my_client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="client-secret-jwt">Client Secret JWT<a class="headerlink" href="#client-secret-jwt" title="Permanent link">&para;</a></h4>
<p>With <strong>client_secret_jwt</strong>, the client generates an ephemeral JWT assertion including information about itself
(client_id), the AS (url of the endpoint), and an expiration date a few seconds in the future. To use it, pass a
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.ClientSecretJwt"><code>ClientSecretJwt(client_id, client_secret)</code></a>
as <code>auth</code> parameter. Assertion generation is entirely automatic, you don't have anything to do:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span>
<span class="normal"><a href="#__codelineno-22-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This method is more secure than the 2 previous, because only ephemeral credentials are transmitted, which limits the
possibility for interception and replay of the Client Secret. But that Client Secret still needs to be shared between
the AS and Client owner(s).</p>
<h4 id="private-key-jwt">Private Key JWT<a class="headerlink" href="#private-key-jwt" title="Permanent link">&para;</a></h4>
<p>With <strong>private_key_jwt</strong>, client uses a JWT assertion that is just like the one for <em>client_secret_jwt</em>, but it is
signed with an <em>asymmetric</em> key. To use it, you need a private signing key, in a <code>dict</code> that matches the JWK format, or
as an instance of <code>jwskate.Jwk</code>. The matching public key must be registered for your client on AS side. Once you have
that, using this auth method is simple with the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.PrivateKeyJwt"><code>PrivateKeyJwt(client_id, private_jwk)</code></a>
auth handler:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">PrivateKeyJwt</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">private_jwk</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>    <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;mykid&quot;</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a>    <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a>    <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a>    <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a>    <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a>    <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a>    <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11"></a>    <span class="s2">&quot;dp&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12"></a>    <span class="s2">&quot;dq&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13"></a>    <span class="s2">&quot;qi&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="p">}</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15"></a>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">PrivateKeyJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">private_jwk</span><span class="p">)</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="p">)</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="c1"># or</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">private_jwk</span><span class="p">)</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22"></a><span class="p">)</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23"></a><span class="c1"># or</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">private_jwk</span><span class="o">=</span><span class="n">private_jwk</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This method can be considered more secure than those relying on a client secret, because only ephemeral credentials are
sent over the wire, and it uses asymmetric cryptography: the signing key is generated by the client, and only the public
key is known by the AS. Transmitting that public key between owner(s) of the client and of the AS is much easier than
transmitting the Client Secret, which is a shared key that must be considered as confidential.</p>
<h4 id="none">None<a class="headerlink" href="#none" title="Permanent link">&para;</a></h4>
<p>The latest Client Authentication Method, <strong>none</strong>, is for Public Clients which do not authenticate to the Token
Endpoint. Those clients only include their <code>client_id</code> in body form data, without any authentication credentials. Use
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client_authentication.PublicApp"><code>PublicApp(client_id)</code></a>:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">PublicApp</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">PublicApp</span><span class="p">(</span><span class="s2">&quot;app_client_id&quot;</span><span class="p">)</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="token-revocation">Token Revocation<a class="headerlink" href="#token-revocation" title="Permanent link">&para;</a></h3>
<p>The <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> class provides methods for sending revocation requests to a Revocation Endpoint. To use this feature,
you need to provide the Revocation Endpoint URI when creating an instance of <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a>.
The available methods for revoking tokens are:</p>
<ul>
<li><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.revoke_token">revoke_token()</a>: Revokes a token by providing the token value and an optional token_type_hint.</li>
<li><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.revoke_access_token">revoke_access_token()</a>: Revokes an access token by providing the token value.</li>
<li><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.revoke_refresh_token">revoke_refresh_token()</a>: Revokes a refresh token by providing the token value.</li>
</ul>
<p>Here is an example of how to use these methods:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5"></a>    <span class="n">revocation_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/revocation_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="p">)</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8"></a>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="n">oauth2client</span><span class="o">.</span><span class="n">revoke_token</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">,</span> <span class="n">token_type_hint</span><span class="o">=</span><span class="s2">&quot;access_token&quot;</span><span class="p">)</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="n">oauth2client</span><span class="o">.</span><span class="n">revoke_access_token</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">)</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11"></a><span class="n">oauth2client</span><span class="o">.</span><span class="n">revoke_refresh_token</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>These methods return a boolean value indicating whether the revocation request was successfully sent and no error was
returned. If the Authorization Server returns a non-successful HTTP code without a standard error message, it will
return <code>False</code>. If the Authorization Server returns a standard error, an exception will be raised.</p>
<h3 id="token-introspection">Token Introspection<a class="headerlink" href="#token-introspection" title="Permanent link">&para;</a></h3>
<p>The <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> class also supports sending requests to a Token Introspection Endpoint.
To use this feature, you need to provide the Introspection Endpoint URI when creating an instance of <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a>.
The <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.instrospect_token()">introspect_token()</a>
method is then available for introspecting tokens:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span>
<span class="normal"><a href="#__codelineno-26-6">6</a></span>
<span class="normal"><a href="#__codelineno-26-7">7</a></span>
<span class="normal"><a href="#__codelineno-26-8">8</a></span>
<span class="normal"><a href="#__codelineno-26-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a>    <span class="n">introspection_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/introspection_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="p">)</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">introspect_token</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">,</span> <span class="n">token_type_hint</span><span class="o">=</span><span class="s2">&quot;access_token&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>The <code>introspect_token()</code> method returns the data returned by the introspection endpoint, decoded if it is in JSON format.</p>
<h3 id="userinfo-requests">UserInfo Requests<a class="headerlink" href="#userinfo-requests" title="Permanent link">&para;</a></h3>
<p>The <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> class also supports sending requests to a UserInfo Endpoint.
To use this feature, you need to provide the UserInfo Endpoint URI when creating an instance of <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a>
The <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.userinfo">userinfo()</a>
method is then available for retrieving user information:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span>
<span class="normal"><a href="#__codelineno-27-5">5</a></span>
<span class="normal"><a href="#__codelineno-27-6">6</a></span>
<span class="normal"><a href="#__codelineno-27-7">7</a></span>
<span class="normal"><a href="#__codelineno-27-8">8</a></span>
<span class="normal"><a href="#__codelineno-27-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4"></a>    <span class="n">token_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5"></a>    <span class="n">userinfo_endpoint</span><span class="o">=</span><span class="s2">&quot;https://url.to.the/userinfo_endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="p">)</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8"></a>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">userinfo</span><span class="p">(</span><span class="s2">&quot;mytoken&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>The <code>userinfo()</code> method returns the data returned by the userinfo endpoint, decoded if it is in JSON format.</p>
<h3 id="initializing-an-oauth2client-from-a-discovery-document">Initializing an <code>OAuth2Client</code> from a discovery document<a class="headerlink" href="#initializing-an-oauth2client-from-a-discovery-document" title="Permanent link">&para;</a></h3>
<p>You can initialize an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> with the endpoint URIs mentioned in a standardised discovery document using the
<a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client.from_discovery_document">OAuth2Client.from_discovery_endpoint()</a>
class method:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ClientSecretJwt</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a>    <span class="s2">&quot;https://url.to.the.as/.well-known/openid-configuration&quot;</span><span class="p">,</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="p">)</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7"></a>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="c1"># OR, if you know the issuer value</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://url.to.the.as&quot;</span><span class="p">,</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">ClientSecretJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This will fetch the document from the specified URI, decode it, and initialize an <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> pointing to the
appropriate endpoint URIs.</p>
<p>If you use the <code>issuer</code> keyword argument, the URI to the discovery endpoint will be deduced from that identifier, and a
check will be made to ensure that the <code>issuer</code> from the retrieved metadata document matches that value.</p>
<h3 id="using-dpop">Using DPoP<a class="headerlink" href="#using-dpop" title="Permanent link">&para;</a></h3>
<h4 id="basic-usage">Basic usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h4>
<p><code>DPoP</code> (Demonstrating Proof of Possession) is supported out-of-the-box. To obtain a <em>DPoP</em> token, you can either:</p>
<ul>
<li>pass <code>dpop=True</code> when using any <code>OAuth2Client</code> method that sends a token request,</li>
<li>or enable <code>DPoP</code> by default by passing <code>dpop_bound_access_tokens=True</code> when initializing your client.</li>
</ul>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span>
<span class="normal"><a href="#__codelineno-29-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">DPoPToken</span><span class="p">,</span> <span class="n">OAuth2Client</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://as.local&quot;</span><span class="p">,</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="p">)</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;my_scope&quot;</span><span class="p">,</span> <span class="n">dpop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">DPoPToken</span><span class="p">)</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10"></a>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="c1"># or, to enable DPoP by default for every token request</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://as.local&quot;</span><span class="p">,</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15"></a>    <span class="n">dpop_bound_access_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="p">)</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;my_scope&quot;</span><span class="p">)</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18"></a><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">DPoPToken</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="about-dpoptoken">About <code>DPoPToken</code><a class="headerlink" href="#about-dpoptoken" title="Permanent link">&para;</a></h4>
<p><code>DPoPToken</code> is actually a <code>BearerToken</code> subclass. If you use it as a <code>requests</code> Auth Handler, it will take care of
adding a <code>DPoP</code> proof to the request headers, in addition to the access token.</p>
<p>Since it is a <code>BearerToken</code> subclass, it is fully compatible with the <code>requests</code> compatible auth handlers provided by
<code>requests_oauth2client</code>, such as <code>OAuth2ClientCredentialsAuth</code>, <code>OAuth2AccessTokenAuth</code>, etc. So you may use DPoP with
those auth handlers like this:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span>
<span class="normal"><a href="#__codelineno-30-16">16</a></span>
<span class="normal"><a href="#__codelineno-30-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span><span class="p">,</span> <span class="n">PrivateKeyJwt</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://my.issuer.local&quot;</span><span class="p">,</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">PrivateKeyJwt</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">),</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7"></a>    <span class="n">dpop_bound_access_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># enable DPoP by default</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="p">)</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="n">session</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12"></a>    <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13"></a>    <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;my_scope&quot;</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="p">)</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15"></a>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://my.api.local/endpoint&quot;</span><span class="p">)</span>  <span class="c1"># this will automatically obtain a DPoP token and use it</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17"></a><span class="k">assert</span> <span class="s2">&quot;DPoP&quot;</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">headers</span>  <span class="c1"># the appropriate DPoP proof will be included in the request</span>
</span></code></pre></div></td></tr></table></div>
<p>Since DPoP is enabled by default with <code>dpop_bound_access_tokens=True</code>, then the <code>OAuth2ClientCredentialsAuth</code> will
obtain and use <code>DPoPToken</code> instances. You could also leave it disabled by default and pass <code>dpop=True</code> when initializing
you auth handler instance: <code>OAuth2ClientCredentialsAuth(client=client, scope="my_scope", dpop=True)</code>.</p>
<h4 id="choosing-your-own-proof-signature-keys">Choosing your own proof signature keys<a class="headerlink" href="#choosing-your-own-proof-signature-keys" title="Permanent link">&para;</a></h4>
<p>By default, the private key used for signing <code>DPoP</code> proofs is auto-generated by <code>OAuth2Client</code> whenever a new token is
obtained. By default, generated keys are of type <em>Elliptic Curve</em> (<code>EC</code>), and use the <code>ES256</code> signature alg (as in
<em>Elliptic-Curve with a SHA256 hash</em>). Should you, for testing purposes, wish to generate or use your own key, you may
use the parameter <code>dpop_key</code> to provide a key of your choice. It takes a <code>DPoPKey</code> instance, which you can generate
using <code>DPoPKey.generate()</code>, or by initializing an instance with a key that you previously generated:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span>
<span class="normal"><a href="#__codelineno-31-19">19</a></span>
<span class="normal"><a href="#__codelineno-31-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jwskate</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">DPoPKey</span><span class="p">,</span> <span class="n">DPoPToken</span><span class="p">,</span> <span class="n">OAuth2Client</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4"></a>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://as.local&quot;</span><span class="p">,</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8"></a>    <span class="n">dpop_bound_access_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="p">)</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10"></a>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="n">dpop_key</span> <span class="o">=</span> <span class="n">DPoPKey</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS512&quot;</span><span class="p">)</span>  <span class="c1"># generate a new DPoP key with an alg of your choice</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12"></a><span class="c1"># or, for testing purposes only, your can load your own key</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13"></a><span class="n">dpop_key</span> <span class="o">=</span> <span class="n">DPoPKey</span><span class="p">(</span><span class="n">private_key</span><span class="o">=</span><span class="n">jwskate</span><span class="o">.</span><span class="n">Jwk</span><span class="p">({</span><span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span> <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span> <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;ES256&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">}))</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14"></a><span class="c1"># or, any key material supported by `jwskate` is supported, so you can also use `cryptography` keys directly,</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15"></a><span class="c1"># but you need to specify the signature `alg` since it is not part of the key itself</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16"></a><span class="n">dpop_key</span> <span class="o">=</span> <span class="n">DPoPKey</span><span class="p">(</span><span class="n">private_key</span><span class="o">=</span><span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">),</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">)</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17"></a>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18"></a><span class="n">token</span> <span class="o">=</span> <span class="n">oauth2client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;my_scope&quot;</span><span class="p">,</span> <span class="n">dpop_key</span><span class="o">=</span><span class="n">dpop_key</span><span class="p">)</span>
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19"></a><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">DPoPToken</span><span class="p">)</span>
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20"></a><span class="k">assert</span> <span class="n">token</span><span class="o">.</span><span class="n">dpop_key</span> <span class="o">==</span> <span class="n">dpop_key</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="hooking-into-dpop-key-and-proof-generation">Hooking into DPoP key and proof generation<a class="headerlink" href="#hooking-into-dpop-key-and-proof-generation" title="Permanent link">&para;</a></h4>
<p>Instead of generating your own keys everytime, you may also control how <code>DPoPKey</code>s are automatically generated. This can
be useful for fuzz-testing, pen-testing or feature-testing the Authorization Server. To choose the signing alg, use the
parameter <code>dpop_alg</code> when initializing your client. This will accordingly determine the key type to generate. You may
also pass a custom <code>dpop_key_generator</code>, which is a callable that accepts a signature <code>alg</code> as parameter, and generates
<code>DPoPKey</code> instances.</p>
<p>You can also override the <code>DPoPToken</code> class with a custom one, which will be used to represent the DPoP token that is
returned by the AS, and then generates proofs and includes those proofs into HTTP requests.</p>
<p>You may use <code>DPoPKey.generate</code> as a helper method for that, or implement your own generator:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span>
<span class="normal"><a href="#__codelineno-32-21">21</a></span>
<span class="normal"><a href="#__codelineno-32-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">DPoPKey</span><span class="p">,</span> <span class="n">DPoPToken</span><span class="p">,</span> <span class="n">OAuth2Client</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomDPoPToken</span><span class="p">(</span><span class="n">DPoPToken</span><span class="p">):</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A custom DPoP token class that places the DPoP proof and token into a non-standard header.&quot;&quot;&quot;</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a>    <span class="n">AUTHORIZATION_HEADER</span> <span class="o">=</span> <span class="s2">&quot;X-Custom-Auth&quot;</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7"></a>    <span class="n">DPOP_HEADER</span> <span class="o">=</span> <span class="s2">&quot;X-DPoP&quot;</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8"></a>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://as.local&quot;</span><span class="p">,</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12"></a>    <span class="n">dpop_bound_access_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># enable DPoP by default</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13"></a>    <span class="n">dpop_alg</span><span class="o">=</span><span class="s2">&quot;RS256&quot;</span><span class="p">,</span> <span class="c1"># choose the signing alg to use, and it will automatically determine the key type to generate.</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14"></a>    <span class="n">dpop_key_generator</span><span class="o">=</span><span class="k">lambda</span> <span class="n">alg</span><span class="p">:</span> <span class="n">DPoPKey</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15"></a>        <span class="n">alg</span><span class="o">=</span><span class="n">alg</span><span class="p">,</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16"></a>        <span class="c1"># those other parameters are for feature testing the AS, or for workarounding AS bugs:</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17"></a>        <span class="n">jwt_typ</span><span class="o">=</span><span class="s2">&quot;jwt+custom&quot;</span><span class="p">,</span> <span class="c1"># you can customize the `typ` that is included in DPoP proof headers</span>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18"></a>        <span class="n">jti_generator</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="c1"># generate unique jti differently than the default UUIDs</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19"></a>        <span class="n">iat_generator</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">12532424</span><span class="p">,</span> <span class="c1"># override `iat` generation in DPoP proofs, here it will return a static value</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20"></a>        <span class="n">dpop_token_class</span><span class="o">=</span><span class="n">CustomDPoPToken</span><span class="p">,</span> <span class="c1"># override the class that represents DPoP tokens</span>
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21"></a>    <span class="p">)</span>
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="about-dpop-nonces">About DPoP nonces<a class="headerlink" href="#about-dpop-nonces" title="Permanent link">&para;</a></h4>
<p>Authorization Server provided <code>DPoP</code> nonces are automatically and transparently handled by <code>OAuth2Client</code>.</p>
<p>Likewise, Resource Server provided <code>DPoP</code> nonces are supported when using the default <code>DPoPToken</code> class.
This includes all requests-compatible auth handlers provided by <code>requests_oauth2client</code>, like <code>OAuth2AccessTokenAuth</code>,
<code>OAuth2ClientCredentialsAuth</code>, <code>OAuth2AuthorizationCodeAuth</code>, etc.</p>
<p>As an example, see the sample below:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://as.local&quot;</span><span class="p">,</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="p">)</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9"></a>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10"></a><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11"></a>    <span class="s2">&quot;https://my.api.local/endpoint&quot;</span><span class="p">,</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span><span class="n">oauth2client</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;my_scope&quot;</span><span class="p">,</span> <span class="n">dpop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Assuming that both the Authorization Server (at https://as.local) and the Resource Server (at https://my.api.local)
require the use of <code>DPoP</code> nonces, then at least 4 different requests are sent as a result of the <code>requests.get()</code> call
above:</p>
<ol>
<li>The first request is to get a token from the Authorization Server, here using a <em>Client Credentials</em> grant and
including a DPoP proof. DPoP also works with all other grant types. That first requests does not include a nonce.
Since the AS requires a DPoP nonce, it replies to that request with an <code>error=use_dpop_nonce</code> flag and a generated DPoP
nonce.</li>
<li>Second request is automatically sent to the AS, this time with a DPoP proof that contains the nonce provided by the AS.
As a result, the AS returns a DPoP token.</li>
<li>
<p>Third request is sent to the target API, with the DPoP token obtained at step 2, and a DPoP proof that does not yet
contain a <code>nonce</code>.
   The response from this call is a <code>401</code> with at least these 2 response headers:</p>
</li>
<li>
<p>a <code>WWW-Authenticate: DPoP error="use_dpop_nonce"</code> header, indicating that a DPoP <code>nonce</code> is requested,</p>
</li>
<li>and a <code>DPoP-Nonce</code> header containing the <code>nonce</code> to use.</li>
<li>a request is sent again to the target API, this time with a DPoP proof that contains the RS provided <code>nonce</code>
   obtained at step 3. Target API then should accept that request, do its own business and return a <code>200</code> response.</li>
</ol>
<p>If you send multiple requests to the same API, instead of using individual calls to <code>requests.get()</code>, <code>requests.post()</code>
etc., you should use a <code>requests.Session</code> or an <code>ApiClient</code>. It will make sure that the obtained access token and
DPoP nonce(s) are reused as long as they are valid, which avoid repeating calls 1 and 2 unnecessarily and consuming more
tokens and nonces than necessary:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="o">.</span><span class="n">from_discovery_endpoint</span><span class="p">(</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4"></a>    <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;https://as.local&quot;</span><span class="p">,</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5"></a>    <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6"></a>    <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span><span class="p">,</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="p">)</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8"></a>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span><span class="s2">&quot;https://my.api.local/&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span><span class="n">oauth2client</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;my_scope&quot;</span><span class="p">,</span> <span class="n">dpop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="n">response1</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span> <span class="c1"># the first call will trigger requests 1. 2. 3. 4. like above</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11"></a><span class="n">response2</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;other_endpoint&quot;</span><span class="p">)</span> <span class="c1"># next calls will reuse the same token and DPoP nonces as long as they are valid.</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="c1"># some time later</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="n">response3</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;other_endpoint&quot;</span><span class="p">)</span> <span class="c1"># new tokens and DPoP nonces will automatically be obtained when the first ones are expired</span>
</span></code></pre></div></td></tr></table></div>
<p>AS and RS provided nonces are memoized independently by the <code>DPoPToken</code> instance, so the amount of "extra" requests to
obtain new DPoP nonces should be minimal.</p>
<h3 id="specialized-api-client">Specialized API Client<a class="headerlink" href="#specialized-api-client" title="Permanent link">&para;</a></h3>
<p>Using APIs usually involves multiple endpoints under the same root url, with a common authentication method. To make it
easier, <code>requests_oauth2client</code> includes a <a href="https://requests.readthedocs.io/en/latest/api/#requests.Session">requests.Session</a> wrapper called <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a>, which takes the root API url
as parameter on initialization. You can then send requests to different endpoints by passing their relative path instead
of the full url. <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> also accepts an <code>auth</code> parameter with an AuthHandler. You can pass any of the OAuth2 Auth
Handler from this module, or any <a href="https://requests.readthedocs.io/en/latest/">requests</a>-compatible
<a href="https://requests.readthedocs.io/en/latest/user/advanced/#custom-authentication">Authentication Handler</a>. Which makes it
very easy to call APIs that are protected with an OAuth2 Client Credentials Grant:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">OAuth2Client</span><span class="p">,</span> <span class="n">ApiClient</span><span class="p">,</span> <span class="n">OAuth2ClientCredentialsAuth</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="n">oauth2client</span> <span class="o">=</span> <span class="n">OAuth2Client</span><span class="p">(</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a>    <span class="s2">&quot;https://url.to.the/token_endpoint&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="p">)</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7"></a>    <span class="s2">&quot;https://myapi.local/root&quot;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="n">OAuth2ClientCredentialsAuth</span><span class="p">(</span><span class="n">oauth2client</span><span class="p">)</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="p">)</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9"></a>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="c1"># will actually send a GET to https://myapi.local/root/resource/foo</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/resource/foo&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Note that <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> will never send requests "outside" its configured root url. The leading <code>/</code> in <code>/resource</code> above
is optional. A leading <code>/</code> will not "reset" the url path to root, which means that you can also write the relative path
without the <code>/</code> and it will automatically be included:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;resource/foo&quot;</span><span class="p">)</span>  <span class="c1"># will also send a GET to https://myapi.local/root/resource/foo</span>
</span></code></pre></div></td></tr></table></div>
<p>You may also pass the path as an iterable of strings (or string-able objects), in which case they will be joined with a
<code>/</code> and appended to the url path:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="c1"># will send a GET to https://myapi.local/root/resource/foo</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s2">&quot;resource&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">])</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="c1"># will send a GET to https://myapi.local/root/users/1234/details</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="mi">1234</span><span class="p">,</span> <span class="s2">&quot;details&quot;</span><span class="p">])</span>
</span></code></pre></div></td></tr></table></div>
<p>You can also use a syntax based on <code>__getattr__</code> or <code>__getitem__</code>:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="n">api</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># will send a GET to https://myapi.local/root/resource</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="n">api</span><span class="p">[</span><span class="s2">&quot;my-resource&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># will send a GET to https://myapi.local/root/my-resource</span>
</span></code></pre></div></td></tr></table></div>
<p>Both <code>__getattr__</code> and <code>__getitem__</code> return a new <code>ApiClient</code> initialised on the new base_url. So you can easily call
multiple sub-resources on the same API this way:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span>
<span class="normal"><a href="#__codelineno-39-3">3</a></span>
<span class="normal"><a href="#__codelineno-39-4">4</a></span>
<span class="normal"><a href="#__codelineno-39-5">5</a></span>
<span class="normal"><a href="#__codelineno-39-6">6</a></span>
<span class="normal"><a href="#__codelineno-39-7">7</a></span>
<span class="normal"><a href="#__codelineno-39-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApiClient</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span><span class="s2">&quot;https://myapi.local&quot;</span><span class="p">)</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="n">users_api</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">users</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="n">user</span> <span class="o">=</span> <span class="n">users_api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;userid&quot;</span><span class="p">)</span>  <span class="c1"># GET https://myapi.local/users/userid</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6"></a><span class="n">other_user</span> <span class="o">=</span> <span class="n">users_api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;other_userid&quot;</span><span class="p">)</span>  <span class="c1"># GET https://myapi.local/users/other_userid</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="n">resources_api</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">resources</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="n">resources</span> <span class="o">=</span> <span class="n">resources_api</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># GET https://myapi.local/resources</span>
</span></code></pre></div></td></tr></table></div>
<p><a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> will, by default, raise exceptions whenever a request returns an error status. You can disable that by
passing <code>raise_for_status=False</code> when initializing your <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a>:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span>
<span class="normal"><a href="#__codelineno-40-5">5</a></span>
<span class="normal"><a href="#__codelineno-40-6">6</a></span>
<span class="normal"><a href="#__codelineno-40-7">7</a></span>
<span class="normal"><a href="#__codelineno-40-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApiClient</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2"></a>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4"></a>    <span class="s2">&quot;http://httpstat.us&quot;</span><span class="p">,</span> <span class="n">raise_for_status</span><span class="o">=</span><span class="kc">False</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="p">)</span>  <span class="c1"># raise_for_status defaults to True</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;500&quot;</span><span class="p">)</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7"></a><span class="k">assert</span> <span class="n">resp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8"></a><span class="c1"># without raise_for_status=False, a requests.exceptions.HTTPError exception would be raised instead</span>
</span></code></pre></div></td></tr></table></div>
<p>You may override this at request time:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="c1"># raise_for_status at request-time overrides the value defined at init-time</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;500&quot;</span><span class="p">,</span> <span class="n">raise_for_status</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>You can access the underlying <code>requests.Session</code> with the session attribute, and you can provide an already existing and
configured <code>Session</code> instance at init time:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span>
<span class="normal"><a href="#__codelineno-42-2">2</a></span>
<span class="normal"><a href="#__codelineno-42-3">3</a></span>
<span class="normal"><a href="#__codelineno-42-4">4</a></span>
<span class="normal"><a href="#__codelineno-42-5">5</a></span>
<span class="normal"><a href="#__codelineno-42-6">6</a></span>
<span class="normal"><a href="#__codelineno-42-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApiClient</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a><span class="n">session</span><span class="o">.</span><span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;https&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:3128&quot;</span><span class="p">}</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">(</span><span class="s2">&quot;https://myapi.local/resource&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7"></a><span class="k">assert</span> <span class="n">api</span><span class="o">.</span><span class="n">session</span> <span class="o">==</span> <span class="n">session</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="vendor-specific-clients">Vendor-Specific clients<a class="headerlink" href="#vendor-specific-clients" title="Permanent link">&para;</a></h3>
<p><code>requests_oauth2client</code> is flexible enough to handle most use cases, so you should be able to use any AS by any vendor
as long as it supports OAuth 2.0.</p>
<p>You can however create a subclass of <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> or <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.api_client.ApiClient">ApiClient</a> to make it easier to use with specific Authorization
Servers or APIs. <a href="https://guillp.github.io/requests_oauth2client/api/#requests_oauth2client.client.OAuth2Client">OAuth2Client</a> has several extensibility points in the form of methods like
<code>OAuth2Client.parse_token_response()</code>, <code>OAuth2Client.on_token_error()</code> that implement response parsing, error handling,
etc.</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-43-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-43-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-43-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-43-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-43-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-43-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-43-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-43-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-43-10">10</a></span>
<span class="normal"><a href="#__codelineno-43-11">11</a></span>
<span class="normal"><a href="#__codelineno-43-12">12</a></span>
<span class="normal"><a href="#__codelineno-43-13">13</a></span>
<span class="normal"><a href="#__codelineno-43-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">requests_oauth2client.vendor_specific</span><span class="w"> </span><span class="kn">import</span> <span class="n">Auth0</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3"></a><span class="n">a0client</span> <span class="o">=</span> <span class="n">Auth0</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4"></a>    <span class="s2">&quot;mytenant.eu&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5"></a><span class="p">)</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6"></a><span class="c1"># this will automatically initialize the token endpoint to https://mytenant.eu.auth0.com/oauth/token</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7"></a><span class="c1"># and other endpoints accordingly</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8"></a><span class="n">token</span> <span class="o">=</span> <span class="n">a0client</span><span class="o">.</span><span class="n">client_credentials</span><span class="p">(</span><span class="n">audience</span><span class="o">=</span><span class="s2">&quot;audience&quot;</span><span class="p">)</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9"></a>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10"></a><span class="c1"># this is a wrapper around Auth0 Management API</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11"></a><span class="n">a0mgmt</span> <span class="o">=</span> <span class="n">Auth0</span><span class="o">.</span><span class="n">management_api_client</span><span class="p">(</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12"></a>    <span class="s2">&quot;mytenant.eu&quot;</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s2">&quot;client_secret&quot;</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13"></a><span class="p">)</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14"></a><span class="n">myusers</span> <span class="o">=</span> <span class="n">a0mgmt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
        
          
          <a href="installation/" class="md-footer__link md-footer__link--next" aria-label="Next: Installation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Installation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/guillp/requests_oauth2client" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:guill.p.linux@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.indexes", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "navigation.footer", "content.code.copy", "content.action.view"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>